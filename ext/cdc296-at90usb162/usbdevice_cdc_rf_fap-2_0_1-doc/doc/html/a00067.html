<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ATMEL: Frequency Agility Protocol</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<h1>Frequency Agility Protocol</h1>Implementation of frequency agility protocol for better robustness against interference from co-existing radio frequency sources.  
<a href="#_details">More...</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Modules</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00068.html">Frequency Agility Protocol HW macros</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Hardware dependent macros for FAP. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00069.html">Frequency Agility Protocol Setup Parameters</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of frequency agility protocol for better robustness against interference from co-existing radio frequency sources. <br></td></tr>

<p>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00001.html">fap_tx_rx_struct_t</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Type used for storing payload, payload length and pipe number.  <a href="a00001.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>General functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g98096286b36e9d7f8df7c9c733b10e5a">fap_init</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization function for the frequency agility protocol (FAP).  <a href="#g98096286b36e9d7f8df7c9c733b10e5a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gaed36c5567ef853d863244f3c8ef85ad">fap_set_address</a> (<a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> dev, <a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> *adr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for setting the explicit receive address for a given pipe.  <a href="#gaed36c5567ef853d863244f3c8ef85ad"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gb108b5cbcc502e40c0dc587014ac3086">fap_get_address</a> (<a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> dev, <a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> *adr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for reading the address set for a given pipe.  <a href="#gb108b5cbcc502e40c0dc587014ac3086"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#ga1e5eeb464c145ed6ce040e07cda1313">fap_set_channels</a> (<a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> *channels)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for setting up the subset of channels to be used by the FAP.  <a href="#ga1e5eeb464c145ed6ce040e07cda1313"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g8460a9f7f7014d96a9f5126a7e2b2fe4">fap_select_radio_idle_mode</a> (<a class="el" href="a00067.html#g155eee989362c6cdac1f164dea1b714c">fap_radio_idle_modes_t</a> mode)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for selecting in which mode the radio shall reside when the FAP is in IDLE mode.  <a href="#g8460a9f7f7014d96a9f5126a7e2b2fe4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g265d0918166f0231f7f87e50005057bb">fap_goto_idle_mode</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for forcing the FAP to IDLE mode.  <a href="#g265d0918166f0231f7f87e50005057bb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="a00067.html#ge9ac64bf8d27b84d9ceede9028c86978">fap_modes_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gd39f595cbc496278f6064561649200c0">fap_get_mode</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for observing the current FAP mode.  <a href="#gd39f595cbc496278f6064561649200c0"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Transmit related functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#ge6147d552537f3b74c7251af34041a35">fap_tx_data</a> (<a class="el" href="a00001.html">fap_tx_rx_struct_t</a> *datainput, <a class="el" href="a00021.html#df928e51a60dba0df29d615401cc55a8">U16</a> tx_timeout)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for transmitting data.  <a href="#ge6147d552537f3b74c7251af34041a35"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#ga4cb8971309f33217e1f0078ad1a3dc0">fap_flush_tx_fifo</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for flushing the hardware transmit FIFO.  <a href="#ga4cb8971309f33217e1f0078ad1a3dc0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g48fb01570bc2097b9edfa3a8812fa94d">fap_write_ack_pload</a> (<a class="el" href="a00001.html">fap_tx_rx_struct_t</a> *ackdata)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for writing data to be piggybacked on the next acknowledge packet sent from the host to a device.  <a href="#g48fb01570bc2097b9edfa3a8812fa94d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g24a15b187addedf58f20ebb0a84503fc">fap_tx_fifo_full</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function returning <b>false</b> if TX FIFO full, else @ true.  <a href="#g24a15b187addedf58f20ebb0a84503fc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gdadf8034a8c5b3e16eada1983070b789">fap_set_output_power</a> (<a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> power)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for setting the radio output power.  <a href="#gdadf8034a8c5b3e16eada1983070b789"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g9d5d854b0084d2bad76bd6730acbbc68">fap_ch_sync_enable</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for enabling a new transmission to be started synchronously to the receiver channel rotation.  <a href="#g9d5d854b0084d2bad76bd6730acbbc68"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gf6e3d10459030c28476c8e00ccfcb561">fap_get_ch_offset</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for getting the offset by the "guessed" receive channel and the previous successful transmit channel.  <a href="#gf6e3d10459030c28476c8e00ccfcb561"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gadbeb049d5ccbd2a7f3ec49cc0792e4c">fap_ch_sync_disable</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for disabling synchronization of transmission frequency to receive frequency.  <a href="#gadbeb049d5ccbd2a7f3ec49cc0792e4c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g83d37651028ee29a9f78d61839dffac8">fap_tx_success</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for getting the result of the previous transmit operation.  <a href="#g83d37651028ee29a9f78d61839dffac8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="a00021.html#df928e51a60dba0df29d615401cc55a8">U16</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gab2d09034e6cbd13aa75ff1e78e2ad3d">fap_get_tries</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for providing the number of transmission attempts needed during the previous transmit operation.  <a href="#gab2d09034e6cbd13aa75ff1e78e2ad3d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="a00021.html#df928e51a60dba0df29d615401cc55a8">U16</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g8c33715acccc57869fab5616c5209929">fap_get_ch_switches</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for providing the number of frequency channel changes needed during the previous transmit operation.  <a href="#g8c33715acccc57869fab5616c5209929"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Receive related functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gec543eeacba621d36cc71eb399a084aa">fap_rx_data</a> (<a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> rx_setup, <a class="el" href="a00021.html#df928e51a60dba0df29d615401cc55a8">U16</a> receive_timeout)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for setting the FAP in receive mode and start monitoring the air for data.  <a href="#gec543eeacba621d36cc71eb399a084aa"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gdaf75426e4c6b294e2d0733d8ef9c2b2">fap_flush_rx_fifo</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for flushing the hardware receive FIFO.  <a href="#gdaf75426e4c6b294e2d0733d8ef9c2b2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#ga01c21a346962faaf73e29722f8dd8bf">fap_read_rx_fifo</a> (<a class="el" href="a00001.html">fap_tx_rx_struct_t</a> *return_struct)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function for reading received data from receive FIFO.  <a href="#ga01c21a346962faaf73e29722f8dd8bf"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Interrupt service routine functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g973ee6d1b243317e14abbbd39e3c3829">fap_nrf_isr_function</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function to be called by the nRF radio interrupt service routine.  <a href="#g973ee6d1b243317e14abbbd39e3c3829"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g7a93db234bd573547615a02e536af4f3">fap_timer_isr_function</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function to be called by the FAP timer interrupt service routine.  <a href="#g7a93db234bd573547615a02e536af4f3"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g504b0e4d90c7a7fe1ee0c7ede28b0108">FAP_DATARATE</a>&nbsp;&nbsp;&nbsp;HAL_NRF_2MBPS</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g759c414b7ea0db9dd71a9c038f563ff7">FAP_OUTPUT_POWER</a>&nbsp;&nbsp;&nbsp;HAL_NRF_0DBM</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g85aa952d9f8de7690706a55b0c5c3cdd">FAP_CRC</a>&nbsp;&nbsp;&nbsp;HAL_NRF_CRC_16BIT</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gdb62d8340e7516d09c3427f436a62fb3">FAP_ADDRESS_WIDTH</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gccd7d43c3b6830cbc3deb246fb68b789">FAP_LP_RX_LISTEN_PERIODS</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g23bd3e9ec003b9292562fea4112240b3">FAP_MAX_PL_LENGTH</a>&nbsp;&nbsp;&nbsp;FAP_MAX_FW_PL_LENGTH</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g66b26d1ad669c2a00dcd1c14cca1b4fd">FAP_AUTO_RETR_DELAY</a>&nbsp;&nbsp;&nbsp;500</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g820e4d71076e3ea505892df88d82b20f">FAP_MAX_TX_PERIOD</a>&nbsp;&nbsp;&nbsp;(130+37+(FAP_MAX_FW_PL_LENGTH*4)+FAP_AUTO_RETR_DELAY)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(a, b)&nbsp;&nbsp;&nbsp;((a &gt;&gt; b) &amp; 0x01)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(a, b)&nbsp;&nbsp;&nbsp;(a &amp;= ~(1 &lt;&lt; b))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(a, b)&nbsp;&nbsp;&nbsp;(a |= (1 &lt;&lt; b))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g84b9c34cb03fefbee1372030b0ff6351">FAP_RADIO_PWR_UP_DELAY</a>&nbsp;&nbsp;&nbsp;((2000/FAP_RX_PERIOD)+1)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Specifies the radio wakeup from power down time.  <a href="#g84b9c34cb03fefbee1372030b0ff6351"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g4b11b2e40f8689191b6f94e90a2e48ab">FAP_TX_SINGLE_CH_REV</a>&nbsp;&nbsp;&nbsp;((FAP_NRF_AUTO_RETRIES+1)*FAP_AUTO_RETRIES_EXTEND)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Equals the number of transmit periods the transmitter resides at one channel before channel switch.  <a href="#g4b11b2e40f8689191b6f94e90a2e48ab"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g59bd94d6e78efe924dfdd89134b236c9">FAP_TX_SINGLE_CH_REV_TIME</a>&nbsp;&nbsp;&nbsp;(FAP_TX_SINGLE_CH_REV*FAP_TX_PERIOD_MAX)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gcaed29a30dc23ca945c96f3c137c3979">FAP_TX_FULL_CH_REV</a>&nbsp;&nbsp;&nbsp;(FAP_TX_SINGLE_CH_REV*FAP_CH_TAB_SIZE)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g188bc23bab0d09baecfaa048dd541a88">FAP_TX_FULL_CH_REV_TIME</a>&nbsp;&nbsp;&nbsp;(FAP_TX_FULL_CH_REV*FAP_TX_PERIOD_MAX)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g88bbdb70a1eeb3f35c6b72ba5cb5e74e">FAP_RX_SINGLE_CH_REV</a>&nbsp;&nbsp;&nbsp;((uint16_t)(((FAP_TX_SINGLE_CH_REV*FAP_MAX_TX_PERIOD)/FAP_RX_PERIOD)+1))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Equals the number of receive periods the transmitter resides on a single channel before channel switch.  <a href="#g88bbdb70a1eeb3f35c6b72ba5cb5e74e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g7fd5e5aa5d3115efc8912c1a43d8f182">FAP_RX_SINGLE_CH_REV_TIME</a>&nbsp;&nbsp;&nbsp;(FAP_RX_SINGLE_CH_REV*FAP_RX_PERIOD)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Specifies the time in [us] that equals the time the transmitter resides on a single channel before channel switch.  <a href="#g7fd5e5aa5d3115efc8912c1a43d8f182"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gc0db914b411d5004cf37446c9a4b0981">FAP_RX_FULL_CH_REV</a>&nbsp;&nbsp;&nbsp;(FAP_RX_SINGLE_CH_REV*FAP_CH_TAB_SIZE)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Equals the number of receive periods the transmitter uses on a full revolution through all channels.  <a href="#gc0db914b411d5004cf37446c9a4b0981"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g3f85a426dd04871b2c9d9a92fea30821">FAP_RX_FULL_CH_REV_TIME</a>&nbsp;&nbsp;&nbsp;(RX_FULL_CH_REV*FAP_RX_PERIOD)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Equals the time in [us] that the transmitter uses on a full revolution through all channels.  <a href="#g3f85a426dd04871b2c9d9a92fea30821"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g7ab1bdd98125b9f7672e0d154fa9b83a">FAP_DEVICE0</a>&nbsp;&nbsp;&nbsp;HAL_NRF_PIPE0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g83cf56497c075f12367594efc2b8efb0">FAP_DEVICE1</a>&nbsp;&nbsp;&nbsp;HAL_NRF_PIPE1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gcfcb9a90111343cbf97ad6fd4d0311e0">FAP_DEVICE2</a>&nbsp;&nbsp;&nbsp;HAL_NRF_PIPE2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g3a5462809ccfb31e2ab44a394d89652a">FAP_DEVICE3</a>&nbsp;&nbsp;&nbsp;HAL_NRF_PIPE3</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#ge77847eda791daf86d3ad81ab885bf18">FAP_DEVICE4</a>&nbsp;&nbsp;&nbsp;HAL_NRF_PIPE4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g4ec445eb93aea50b8f9b52f5f947c9f5">FAP_DEVICE5</a>&nbsp;&nbsp;&nbsp;HAL_NRF_PIPE5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gd579a706380c94617a85dd2c827035df">FAP_LP_RX_BIT</a>&nbsp;&nbsp;&nbsp;(FAP_DEVICE5+1)</td></tr>

<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#ge9ac64bf8d27b84d9ceede9028c86978">fap_modes_t</a> { <a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2">FAP_IDLE</a>, 
<a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c869789c4a1edf3ad50e19eaf13e1d7892cc2f">FAP_TRANSMITTING</a>, 
<a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697867e95ead0704559b85e6193170e13392">FAP_RECEIVING</a>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Possible FAP modes.  <a href="a00067.html#ge9ac64bf8d27b84d9ceede9028c86978">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gd456aec30b0b1df4a5993cff024c981c">fap_rx_status_t</a> { <a class="el" href="a00067.html#ggd456aec30b0b1df4a5993cff024c981cce16f9a4d7836d1c112f0adb50fa2817">FAP_RX_FIFO_EMPTY</a>, 
<a class="el" href="a00067.html#ggd456aec30b0b1df4a5993cff024c981ce9e491d81f55bd5b7938e9e02a2b93b1">FAP_RX_DATA_IN_FIFO</a>, 
<a class="el" href="a00067.html#ggd456aec30b0b1df4a5993cff024c981cdb10d843f5f067e5eeca9ed941581713">FAP_RX_FIFO_FULL</a>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Possible RX fifo states.  <a href="a00067.html#gd456aec30b0b1df4a5993cff024c981c">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#g155eee989362c6cdac1f164dea1b714c">fap_radio_idle_modes_t</a> { <a class="el" href="a00067.html#gg155eee989362c6cdac1f164dea1b714c9352df39fbc375a503d6826b4a69bbec">FAP_PDOWN_IDLE</a>, 
<a class="el" href="a00067.html#gg155eee989362c6cdac1f164dea1b714c4b18144311936eb85bfa69132e4cecbe">FAP_STANDBY_IDLE</a>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Possible radio modes during FAP IDLE mode.  <a href="a00067.html#g155eee989362c6cdac1f164dea1b714c">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00067.html#gc448074facafef1f43e296c8fd60d6d0">fap_modify_timer_period</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function used internally by the FAP for a device to synchronize to the host receive channel rotation.  <a href="#gc448074facafef1f43e296c8fd60d6d0"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Implementation of frequency agility protocol for better robustness against interference from co-existing radio frequency sources. 
<p>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="g504b0e4d90c7a7fe1ee0c7ede28b0108"></a><!-- doxytag: member="fap.h::FAP_DATARATE" ref="g504b0e4d90c7a7fe1ee0c7ede28b0108" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_DATARATE&nbsp;&nbsp;&nbsp;HAL_NRF_2MBPS          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00036">36</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00090">fap_init()</a>.
</div>
</div><p>
<a class="anchor" name="g759c414b7ea0db9dd71a9c038f563ff7"></a><!-- doxytag: member="fap.h::FAP_OUTPUT_POWER" ref="g759c414b7ea0db9dd71a9c038f563ff7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_OUTPUT_POWER&nbsp;&nbsp;&nbsp;HAL_NRF_0DBM          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00038">38</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00090">fap_init()</a>.
</div>
</div><p>
<a class="anchor" name="g85aa952d9f8de7690706a55b0c5c3cdd"></a><!-- doxytag: member="fap.h::FAP_CRC" ref="g85aa952d9f8de7690706a55b0c5c3cdd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_CRC&nbsp;&nbsp;&nbsp;HAL_NRF_CRC_16BIT          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00039">39</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00090">fap_init()</a>.
</div>
</div><p>
<a class="anchor" name="gdb62d8340e7516d09c3427f436a62fb3"></a><!-- doxytag: member="fap.h::FAP_ADDRESS_WIDTH" ref="gdb62d8340e7516d09c3427f436a62fb3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_ADDRESS_WIDTH&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00040">40</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00090">fap_init()</a>, and <a class="el" href="a00094.html#l00145">fap_set_address()</a>.
</div>
</div><p>
<a class="anchor" name="gccd7d43c3b6830cbc3deb246fb68b789"></a><!-- doxytag: member="fap.h::FAP_LP_RX_LISTEN_PERIODS" ref="gccd7d43c3b6830cbc3deb246fb68b789" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_LP_RX_LISTEN_PERIODS&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00041">41</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00592">fap_timer_isr_function()</a>.
</div>
</div><p>
<a class="anchor" name="g23bd3e9ec003b9292562fea4112240b3"></a><!-- doxytag: member="fap.h::FAP_MAX_PL_LENGTH" ref="g23bd3e9ec003b9292562fea4112240b3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_MAX_PL_LENGTH&nbsp;&nbsp;&nbsp;FAP_MAX_FW_PL_LENGTH          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00044">44</a> of file <a class="el" href="a00095.html">fap.h</a>.
</div>
</div><p>
<a class="anchor" name="g66b26d1ad669c2a00dcd1c14cca1b4fd"></a><!-- doxytag: member="fap.h::FAP_AUTO_RETR_DELAY" ref="g66b26d1ad669c2a00dcd1c14cca1b4fd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_AUTO_RETR_DELAY&nbsp;&nbsp;&nbsp;500          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00050">50</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00090">fap_init()</a>.
</div>
</div><p>
<a class="anchor" name="g820e4d71076e3ea505892df88d82b20f"></a><!-- doxytag: member="fap.h::FAP_MAX_TX_PERIOD" ref="g820e4d71076e3ea505892df88d82b20f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_MAX_TX_PERIOD&nbsp;&nbsp;&nbsp;(130+37+(FAP_MAX_FW_PL_LENGTH*4)+FAP_AUTO_RETR_DELAY)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00055">55</a> of file <a class="el" href="a00095.html">fap.h</a>.
</div>
</div><p>
<a class="anchor" name="g7c799138f2a82a777244f453d993acf9"></a><!-- doxytag: member="fap.h::FAP_GET_BIT" ref="g7c799138f2a82a777244f453d993acf9" args="(a, b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_GET_BIT          </td>
          <td>(</td>
          <td class="paramtype">a,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">b&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;((a &gt;&gt; b) &amp; 0x01)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00061">61</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00480">fap_get_ch_offset()</a>, <a class="el" href="a00094.html#l00503">fap_nrf_isr_function()</a>, <a class="el" href="a00094.html#l00178">fap_rx_data()</a>, <a class="el" href="a00094.html#l00730">fap_set_system_idle()</a>, <a class="el" href="a00094.html#l00592">fap_timer_isr_function()</a>, <a class="el" href="a00094.html#l00241">fap_tx_data()</a>, and <a class="el" href="a00094.html#l00412">fap_tx_success()</a>.
</div>
</div><p>
<a class="anchor" name="gb647c79572b09f3c7b8cdeb6deaea05d"></a><!-- doxytag: member="fap.h::FAP_CLEAR_BIT" ref="gb647c79572b09f3c7b8cdeb6deaea05d" args="(a, b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_CLEAR_BIT          </td>
          <td>(</td>
          <td class="paramtype">a,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">b&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;(a &amp;= ~(1 &lt;&lt; b))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00062">62</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00471">fap_ch_sync_disable()</a>, <a class="el" href="a00094.html#l00694">fap_goto_idle_mode()</a>, <a class="el" href="a00094.html#l00090">fap_init()</a>, <a class="el" href="a00094.html#l00503">fap_nrf_isr_function()</a>, <a class="el" href="a00094.html#l00178">fap_rx_data()</a>, <a class="el" href="a00094.html#l00417">fap_select_radio_idle_mode()</a>, <a class="el" href="a00094.html#l00730">fap_set_system_idle()</a>, <a class="el" href="a00094.html#l00592">fap_timer_isr_function()</a>, and <a class="el" href="a00094.html#l00241">fap_tx_data()</a>.
</div>
</div><p>
<a class="anchor" name="ge693b6149cda30d26146738f1e1642e2"></a><!-- doxytag: member="fap.h::FAP_SET_BIT" ref="ge693b6149cda30d26146738f1e1642e2" args="(a, b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_SET_BIT          </td>
          <td>(</td>
          <td class="paramtype">a,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">b&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;(a |= (1 &lt;&lt; b))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00063">63</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00462">fap_ch_sync_enable()</a>, <a class="el" href="a00094.html#l00090">fap_init()</a>, <a class="el" href="a00094.html#l00503">fap_nrf_isr_function()</a>, <a class="el" href="a00094.html#l00178">fap_rx_data()</a>, <a class="el" href="a00094.html#l00417">fap_select_radio_idle_mode()</a>, <a class="el" href="a00094.html#l00592">fap_timer_isr_function()</a>, and <a class="el" href="a00094.html#l00241">fap_tx_data()</a>.
</div>
</div><p>
<a class="anchor" name="g84b9c34cb03fefbee1372030b0ff6351"></a><!-- doxytag: member="fap.h::FAP_RADIO_PWR_UP_DELAY" ref="g84b9c34cb03fefbee1372030b0ff6351" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_RADIO_PWR_UP_DELAY&nbsp;&nbsp;&nbsp;((2000/FAP_RX_PERIOD)+1)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Specifies the radio wakeup from power down time. 
<p>
This constant is specifies in number of FAP_RX_PERIODs. 
<p>
Definition at line <a class="el" href="a00095.html#l00073">73</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00480">fap_get_ch_offset()</a>, <a class="el" href="a00094.html#l00592">fap_timer_isr_function()</a>, and <a class="el" href="a00094.html#l00241">fap_tx_data()</a>.
</div>
</div><p>
<a class="anchor" name="g4b11b2e40f8689191b6f94e90a2e48ab"></a><!-- doxytag: member="fap.h::FAP_TX_SINGLE_CH_REV" ref="g4b11b2e40f8689191b6f94e90a2e48ab" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_TX_SINGLE_CH_REV&nbsp;&nbsp;&nbsp;((FAP_NRF_AUTO_RETRIES+1)*FAP_AUTO_RETRIES_EXTEND)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Equals the number of transmit periods the transmitter resides at one channel before channel switch. 
<p>
This period equals the duration between the start of each retransmit, and is derived form the retransmit delay and "on air" packet length. The maximum length of one transmit period in [us] is specified by <a class="el" href="a00067.html#g820e4d71076e3ea505892df88d82b20f">FAP_MAX_TX_PERIOD</a>. 
<p>
Definition at line <a class="el" href="a00095.html#l00081">81</a> of file <a class="el" href="a00095.html">fap.h</a>.
</div>
</div><p>
<a class="anchor" name="g59bd94d6e78efe924dfdd89134b236c9"></a><!-- doxytag: member="fap.h::FAP_TX_SINGLE_CH_REV_TIME" ref="g59bd94d6e78efe924dfdd89134b236c9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_TX_SINGLE_CH_REV_TIME&nbsp;&nbsp;&nbsp;(FAP_TX_SINGLE_CH_REV*FAP_TX_PERIOD_MAX)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00087">87</a> of file <a class="el" href="a00095.html">fap.h</a>.
</div>
</div><p>
<a class="anchor" name="gcaed29a30dc23ca945c96f3c137c3979"></a><!-- doxytag: member="fap.h::FAP_TX_FULL_CH_REV" ref="gcaed29a30dc23ca945c96f3c137c3979" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_TX_FULL_CH_REV&nbsp;&nbsp;&nbsp;(FAP_TX_SINGLE_CH_REV*FAP_CH_TAB_SIZE)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00095">95</a> of file <a class="el" href="a00095.html">fap.h</a>.
</div>
</div><p>
<a class="anchor" name="g188bc23bab0d09baecfaa048dd541a88"></a><!-- doxytag: member="fap.h::FAP_TX_FULL_CH_REV_TIME" ref="g188bc23bab0d09baecfaa048dd541a88" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_TX_FULL_CH_REV_TIME&nbsp;&nbsp;&nbsp;(FAP_TX_FULL_CH_REV*FAP_TX_PERIOD_MAX)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00101">101</a> of file <a class="el" href="a00095.html">fap.h</a>.
</div>
</div><p>
<a class="anchor" name="g88bbdb70a1eeb3f35c6b72ba5cb5e74e"></a><!-- doxytag: member="fap.h::FAP_RX_SINGLE_CH_REV" ref="g88bbdb70a1eeb3f35c6b72ba5cb5e74e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_RX_SINGLE_CH_REV&nbsp;&nbsp;&nbsp;((uint16_t)(((FAP_TX_SINGLE_CH_REV*FAP_MAX_TX_PERIOD)/FAP_RX_PERIOD)+1))          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Equals the number of receive periods the transmitter resides on a single channel before channel switch. 
<p>
The length of one transmit period in [us] is specified by FAP_RX_PERIOD. 
<p>
Definition at line <a class="el" href="a00095.html#l00108">108</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00592">fap_timer_isr_function()</a>.
</div>
</div><p>
<a class="anchor" name="g7fd5e5aa5d3115efc8912c1a43d8f182"></a><!-- doxytag: member="fap.h::FAP_RX_SINGLE_CH_REV_TIME" ref="g7fd5e5aa5d3115efc8912c1a43d8f182" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_RX_SINGLE_CH_REV_TIME&nbsp;&nbsp;&nbsp;(FAP_RX_SINGLE_CH_REV*FAP_RX_PERIOD)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Specifies the time in [us] that equals the time the transmitter resides on a single channel before channel switch. 
<p>
Thus, FAP_RX_SINGLE_CH_REV_TIME=FAP_TX_SINGLE_CH_REV_TIME. 
<p>
Definition at line <a class="el" href="a00095.html#l00124">124</a> of file <a class="el" href="a00095.html">fap.h</a>.
</div>
</div><p>
<a class="anchor" name="gc0db914b411d5004cf37446c9a4b0981"></a><!-- doxytag: member="fap.h::FAP_RX_FULL_CH_REV" ref="gc0db914b411d5004cf37446c9a4b0981" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_RX_FULL_CH_REV&nbsp;&nbsp;&nbsp;(FAP_RX_SINGLE_CH_REV*FAP_CH_TAB_SIZE)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Equals the number of receive periods the transmitter uses on a full revolution through all channels. 
<p>
The length of one transmit period in [us] is specified by FAP_RX_PERIOD. 
<p>
Definition at line <a class="el" href="a00095.html#l00131">131</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00592">fap_timer_isr_function()</a>.
</div>
</div><p>
<a class="anchor" name="g3f85a426dd04871b2c9d9a92fea30821"></a><!-- doxytag: member="fap.h::FAP_RX_FULL_CH_REV_TIME" ref="g3f85a426dd04871b2c9d9a92fea30821" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_RX_FULL_CH_REV_TIME&nbsp;&nbsp;&nbsp;(RX_FULL_CH_REV*FAP_RX_PERIOD)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Equals the time in [us] that the transmitter uses on a full revolution through all channels. 
<p>
Thus FAP_RX_FULL_CH_REV=FAP_TX_FULL_CH_REV. 
<p>
Definition at line <a class="el" href="a00095.html#l00138">138</a> of file <a class="el" href="a00095.html">fap.h</a>.
</div>
</div><p>
<a class="anchor" name="g7ab1bdd98125b9f7672e0d154fa9b83a"></a><!-- doxytag: member="fap.h::FAP_DEVICE0" ref="g7ab1bdd98125b9f7672e0d154fa9b83a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_DEVICE0&nbsp;&nbsp;&nbsp;HAL_NRF_PIPE0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00184">184</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00241">fap_tx_data()</a>.
</div>
</div><p>
<a class="anchor" name="g83cf56497c075f12367594efc2b8efb0"></a><!-- doxytag: member="fap.h::FAP_DEVICE1" ref="g83cf56497c075f12367594efc2b8efb0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_DEVICE1&nbsp;&nbsp;&nbsp;HAL_NRF_PIPE1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00185">185</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00241">fap_tx_data()</a>.
</div>
</div><p>
<a class="anchor" name="gcfcb9a90111343cbf97ad6fd4d0311e0"></a><!-- doxytag: member="fap.h::FAP_DEVICE2" ref="gcfcb9a90111343cbf97ad6fd4d0311e0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_DEVICE2&nbsp;&nbsp;&nbsp;HAL_NRF_PIPE2          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00186">186</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00241">fap_tx_data()</a>.
</div>
</div><p>
<a class="anchor" name="g3a5462809ccfb31e2ab44a394d89652a"></a><!-- doxytag: member="fap.h::FAP_DEVICE3" ref="g3a5462809ccfb31e2ab44a394d89652a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_DEVICE3&nbsp;&nbsp;&nbsp;HAL_NRF_PIPE3          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00187">187</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00241">fap_tx_data()</a>.
</div>
</div><p>
<a class="anchor" name="ge77847eda791daf86d3ad81ab885bf18"></a><!-- doxytag: member="fap.h::FAP_DEVICE4" ref="ge77847eda791daf86d3ad81ab885bf18" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_DEVICE4&nbsp;&nbsp;&nbsp;HAL_NRF_PIPE4          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00188">188</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00241">fap_tx_data()</a>.
</div>
</div><p>
<a class="anchor" name="g4ec445eb93aea50b8f9b52f5f947c9f5"></a><!-- doxytag: member="fap.h::FAP_DEVICE5" ref="g4ec445eb93aea50b8f9b52f5f947c9f5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_DEVICE5&nbsp;&nbsp;&nbsp;HAL_NRF_PIPE5          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00189">189</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00241">fap_tx_data()</a>.
</div>
</div><p>
<a class="anchor" name="gd579a706380c94617a85dd2c827035df"></a><!-- doxytag: member="fap.h::FAP_LP_RX_BIT" ref="gd579a706380c94617a85dd2c827035df" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FAP_LP_RX_BIT&nbsp;&nbsp;&nbsp;(FAP_DEVICE5+1)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00095.html#l00190">190</a> of file <a class="el" href="a00095.html">fap.h</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00178">fap_rx_data()</a>.
</div>
</div><p>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="ge9ac64bf8d27b84d9ceede9028c86978"></a><!-- doxytag: member="fap.h::fap_modes_t" ref="ge9ac64bf8d27b84d9ceede9028c86978" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a00067.html#ge9ac64bf8d27b84d9ceede9028c86978">fap_modes_t</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Possible FAP modes. 
<p>
Return values for function <a class="el" href="a00067.html#gd39f595cbc496278f6064561649200c0">fap_get_mode()</a>. <dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2"></a><!-- doxytag: member="FAP_IDLE" ref="gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2" args="" -->FAP_IDLE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="gge9ac64bf8d27b84d9ceede9028c869789c4a1edf3ad50e19eaf13e1d7892cc2f"></a><!-- doxytag: member="FAP_TRANSMITTING" ref="gge9ac64bf8d27b84d9ceede9028c869789c4a1edf3ad50e19eaf13e1d7892cc2f" args="" -->FAP_TRANSMITTING</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="gge9ac64bf8d27b84d9ceede9028c8697867e95ead0704559b85e6193170e13392"></a><!-- doxytag: member="FAP_RECEIVING" ref="gge9ac64bf8d27b84d9ceede9028c8697867e95ead0704559b85e6193170e13392" args="" -->FAP_RECEIVING</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="a00095.html#l00157">157</a> of file <a class="el" href="a00095.html">fap.h</a>.<div class="fragment"><pre class="fragment"><a name="l00158"></a>00158 {
<a name="l00159"></a>00159   <a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2">FAP_IDLE</a>,
<a name="l00160"></a>00160   <a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c869789c4a1edf3ad50e19eaf13e1d7892cc2f">FAP_TRANSMITTING</a>,
<a name="l00161"></a>00161   <a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697867e95ead0704559b85e6193170e13392">FAP_RECEIVING</a>
<a name="l00162"></a>00162 }<a class="code" href="a00067.html#ge9ac64bf8d27b84d9ceede9028c86978">fap_modes_t</a>;
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gd456aec30b0b1df4a5993cff024c981c"></a><!-- doxytag: member="fap.h::fap_rx_status_t" ref="gd456aec30b0b1df4a5993cff024c981c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a00067.html#gd456aec30b0b1df4a5993cff024c981c">fap_rx_status_t</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Possible RX fifo states. 
<p>
Return values for function fap_get_rx_fifo_status(). <dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="ggd456aec30b0b1df4a5993cff024c981cce16f9a4d7836d1c112f0adb50fa2817"></a><!-- doxytag: member="FAP_RX_FIFO_EMPTY" ref="ggd456aec30b0b1df4a5993cff024c981cce16f9a4d7836d1c112f0adb50fa2817" args="" -->FAP_RX_FIFO_EMPTY</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="ggd456aec30b0b1df4a5993cff024c981ce9e491d81f55bd5b7938e9e02a2b93b1"></a><!-- doxytag: member="FAP_RX_DATA_IN_FIFO" ref="ggd456aec30b0b1df4a5993cff024c981ce9e491d81f55bd5b7938e9e02a2b93b1" args="" -->FAP_RX_DATA_IN_FIFO</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="ggd456aec30b0b1df4a5993cff024c981cdb10d843f5f067e5eeca9ed941581713"></a><!-- doxytag: member="FAP_RX_FIFO_FULL" ref="ggd456aec30b0b1df4a5993cff024c981cdb10d843f5f067e5eeca9ed941581713" args="" -->FAP_RX_FIFO_FULL</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="a00095.html#l00167">167</a> of file <a class="el" href="a00095.html">fap.h</a>.<div class="fragment"><pre class="fragment"><a name="l00168"></a>00168 {
<a name="l00169"></a>00169   <a class="code" href="a00067.html#ggd456aec30b0b1df4a5993cff024c981cce16f9a4d7836d1c112f0adb50fa2817">FAP_RX_FIFO_EMPTY</a>,
<a name="l00170"></a>00170   <a class="code" href="a00067.html#ggd456aec30b0b1df4a5993cff024c981ce9e491d81f55bd5b7938e9e02a2b93b1">FAP_RX_DATA_IN_FIFO</a>,
<a name="l00171"></a>00171   <a class="code" href="a00067.html#ggd456aec30b0b1df4a5993cff024c981cdb10d843f5f067e5eeca9ed941581713">FAP_RX_FIFO_FULL</a>,
<a name="l00172"></a>00172 }<a class="code" href="a00067.html#gd456aec30b0b1df4a5993cff024c981c">fap_rx_status_t</a>;
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g155eee989362c6cdac1f164dea1b714c"></a><!-- doxytag: member="fap.h::fap_radio_idle_modes_t" ref="g155eee989362c6cdac1f164dea1b714c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a00067.html#g155eee989362c6cdac1f164dea1b714c">fap_radio_idle_modes_t</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Possible radio modes during FAP IDLE mode. 
<p>
Input parameters for function <a class="el" href="a00067.html#g8460a9f7f7014d96a9f5126a7e2b2fe4">fap_select_radio_idle_mode()</a>. <dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="gg155eee989362c6cdac1f164dea1b714c9352df39fbc375a503d6826b4a69bbec"></a><!-- doxytag: member="FAP_PDOWN_IDLE" ref="gg155eee989362c6cdac1f164dea1b714c9352df39fbc375a503d6826b4a69bbec" args="" -->FAP_PDOWN_IDLE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg155eee989362c6cdac1f164dea1b714c4b18144311936eb85bfa69132e4cecbe"></a><!-- doxytag: member="FAP_STANDBY_IDLE" ref="gg155eee989362c6cdac1f164dea1b714c4b18144311936eb85bfa69132e4cecbe" args="" -->FAP_STANDBY_IDLE</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="a00095.html#l00178">178</a> of file <a class="el" href="a00095.html">fap.h</a>.<div class="fragment"><pre class="fragment"><a name="l00179"></a>00179 {
<a name="l00180"></a>00180   <a class="code" href="a00067.html#gg155eee989362c6cdac1f164dea1b714c9352df39fbc375a503d6826b4a69bbec">FAP_PDOWN_IDLE</a>,
<a name="l00181"></a>00181   <a class="code" href="a00067.html#gg155eee989362c6cdac1f164dea1b714c4b18144311936eb85bfa69132e4cecbe">FAP_STANDBY_IDLE</a> 
<a name="l00182"></a>00182 }<a class="code" href="a00067.html#g155eee989362c6cdac1f164dea1b714c">fap_radio_idle_modes_t</a>;
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="gc448074facafef1f43e296c8fd60d6d0"></a><!-- doxytag: member="fap.h::fap_modify_timer_period" ref="gc448074facafef1f43e296c8fd60d6d0" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fap_modify_timer_period           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function used internally by the FAP for a device to synchronize to the host receive channel rotation. 
<p>
This function must be customized for the actual MCU implementation. It is required from this function that when issued, the FAP protocol timer shall be adjusted to generate an interrupt FAP_TIMER_MODIFY_PERIOD microseconds after the point issued. Subsequently this interrupt the protocol timer shall retain the original setup (timeout every FAP_RX_PERIOD us). 
<p>
Definition at line <a class="el" href="a00098.html#l00243">243</a> of file <a class="el" href="a00098.html">FAPtoNRF_API.c</a>.
<p>
Referenced by <a class="el" href="a00094.html#l00503">fap_nrf_isr_function()</a>.<div class="fragment"><pre class="fragment"><a name="l00244"></a>00244 {
<a name="l00245"></a>00245   OCR0A = <a class="code" href="a00059.html#a3ef2670989c490bcfd08f8d7b0c9e75">FAP_TIMER_MODIFY_PERIOD</a> / 4;           <span class="comment">// /4 because TIMER0 has 4s time unit.</span>
<a name="l00246"></a>00246 }
</pre></div>
<p>

<p>
Here is the caller graph for this function:<p><center><img src="a00067_gc448074facafef1f43e296c8fd60d6d0_icgraph.png" border="0" usemap="#a00067_gc448074facafef1f43e296c8fd60d6d0_icgraph_map" alt=""></center>
<map name="a00067_gc448074facafef1f43e296c8fd60d6d0_icgraph_map">
<area href="a00067.html#g973ee6d1b243317e14abbbd39e3c3829" shape="rect" coords="225,5,364,32" alt="">
<area href="a00019.html#c44934ce91e0b9d184169b40720b581d" shape="rect" coords="415,5,535,32" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="g98096286b36e9d7f8df7c9c733b10e5a"></a><!-- doxytag: member="fap.h::fap_init" ref="g98096286b36e9d7f8df7c9c733b10e5a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fap_init           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialization function for the frequency agility protocol (FAP). 
<p>
This function must be called at least once before any of the remaining FAP functions may be used. It is recommended that the FAP timer interrupt service routine is not enabled until after the FAP is initialized. 
<p>
&lt; Disables the tranceiver<p>
&lt;'FEATURE' register address<p>
&lt; Returns the value of the register<p>
&lt; 'Enable dynamic payload length' register address<p>
&lt; Returns the value of the register<p>
&lt;'FEATURE' register address<p>
&lt;'FEATURE' register address<p>
&lt; Enables the payload acknoledgment<p>
&lt;'FEATURE' register address<p>
&lt;'FEATURE' register address<p>
&lt; Enable Dynamic Payload Length<p>
&lt; 'Enable dynamic payload length' register address<p>
&lt; Setup Dynamic Payload Length<p>
&lt; Set baud rate to 2M bit/s<p>
&lt; Sets the transmission baud rate<p>
&lt; Setup transmit auto retry with delay<p>
&lt; Output power set to 0dBm<p>
&lt; Sets the output signal power (0 to 3)<p>
&lt; Enable 16 Bit CRC check<p>
&lt; Sets the CRC Mode (0:OFF, 1: 8 Bit, 2: 16 Bit)<p>
&lt; Returns the irq flags and clear them<p>
&lt; flushs the rx buffer<p>
&lt; flushs the tx buffer 
<p>
Definition at line <a class="el" href="a00094.html#l00090">90</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00099.html#l00099">CE_LOW</a>, <a class="el" href="a00099.html#l00081">DYNPD</a>, <a class="el" href="a00095.html#l00040">FAP_ADDRESS_WIDTH</a>, <a class="el" href="a00095.html#l00050">FAP_AUTO_RETR_DELAY</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b5a9539514e56b772a2c2049e8acc0708">FAP_CH_SYNC_EN</a>, <a class="el" href="a00094.html#l00077">fap_ch_tab_idx_rx</a>, <a class="el" href="a00094.html#l00076">fap_ch_tab_idx_tx</a>, <a class="el" href="a00095.html#l00062">FAP_CLEAR_BIT</a>, <a class="el" href="a00095.html#l00039">FAP_CRC</a>, <a class="el" href="a00095.html#l00036">FAP_DATARATE</a>, <a class="el" href="a00094.html#l00078">fap_hold_rx_channel</a>, <a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2">FAP_IDLE</a>, <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b6f11fadf5d6a6de810c7bb73ebd5e4c7">FAP_LP_RX_EN</a>, <a class="el" href="a00094.html#l00073">fap_mode</a>, <a class="el" href="a00128.html#l00148">FAP_NRF_AUTO_RETRIES</a>, <a class="el" href="a00095.html#l00038">FAP_OUTPUT_POWER</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b8625cc7129d0e8049f1061d323a52535">FAP_PDOWN_IDLE_EN</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>, <a class="el" href="a00094.html#l00043">fap_rx_channel_guess</a>, <a class="el" href="a00095.html#l00063">FAP_SET_BIT</a>, <a class="el" href="a00094.html#l00065">fap_status</a>, <a class="el" href="a00094.html#l00072">fap_timer_period</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b3b65e04ae72d05978f8f3fb5d1fe5b58">FAP_TX_SUCCESS</a>, <a class="el" href="a00099.html#l00082">FEATURE</a>, <a class="el" href="a00099.html#l00107">hal_nrf_enable_ack_pl</a>, <a class="el" href="a00099.html#l00143">hal_nrf_enable_dynamic_pl</a>, <a class="el" href="a00099.html#l00110">hal_nrf_flush_rx</a>, <a class="el" href="a00099.html#l00111">hal_nrf_flush_tx</a>, <a class="el" href="a00099.html#l00140">hal_nrf_get_clear_irq_flags</a>, <a class="el" href="a00098.html#l00227">hal_nrf_lock_unlock()</a>, <a class="el" href="a00099.html#l00105">hal_nrf_read_reg</a>, <a class="el" href="a00099.html#l00124">hal_nrf_set_address_width</a>, <a class="el" href="a00099.html#l00145">hal_nrf_set_auto_retr</a>, <a class="el" href="a00099.html#l00119">hal_nrf_set_crc_mode</a>, <a class="el" href="a00099.html#l00118">hal_nrf_set_datarate</a>, <a class="el" href="a00099.html#l00115">hal_nrf_set_output_power</a>, and <a class="el" href="a00099.html#l00144">hal_nrf_setup_dyn_pl</a>.
<p>
Referenced by <a class="el" href="a00088.html#l00135">cdc_rf_task()</a>, and <a class="el" href="a00088.html#l00099">cdc_rf_task_init()</a>.<div class="fragment"><pre class="fragment"><a name="l00091"></a>00091 {
<a name="l00092"></a>00092   <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00093"></a>00093 
<a name="l00094"></a>00094   <a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a>=<a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2">FAP_IDLE</a>;
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <a class="code" href="a00030.html#2507e21a12efd35e9e9221903456fbc9">CE_LOW</a>();
<a name="l00097"></a>00097   
<a name="l00098"></a>00098   <span class="comment">// Activate hidden features</span>
<a name="l00099"></a>00099   <span class="keywordflow">if</span>(<a class="code" href="a00030.html#fca9e65f7330ace9ee42489f488c33c9">hal_nrf_read_reg</a>(<a class="code" href="a00030.html#df81f7b30b6c08465ce704956b446a2d">FEATURE</a>) != 0x06 || (<a class="code" href="a00030.html#fca9e65f7330ace9ee42489f488c33c9">hal_nrf_read_reg</a>(<a class="code" href="a00030.html#e79cde384e0b6a5549efb001589a79ec">DYNPD</a>) != 0x3F))
<a name="l00100"></a>00100   {
<a name="l00101"></a>00101     <a class="code" href="a00029.html#879863f7f7be332410d790b5cbb2c912">hal_nrf_lock_unlock</a>();
<a name="l00102"></a>00102     <a class="code" href="a00030.html#bfebd7a1f3a3e4dc8d2790a88055e1f8">hal_nrf_enable_ack_pl</a>();
<a name="l00103"></a>00103     <a class="code" href="a00030.html#04a057b25612826e0338615554bf7c1d">hal_nrf_enable_dynamic_pl</a>();
<a name="l00104"></a>00104     <a class="code" href="a00030.html#42186ca9eaadf3bf9183bbf4415d56d1">hal_nrf_setup_dyn_pl</a>(0xff);   <span class="comment">// Use dynamic PL for all pipes</span>
<a name="l00105"></a>00105   }
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   <a class="code" href="a00025.html#d15e0b7d57aef8a352b93df6511342cb">fap_ch_tab_idx_tx</a>=0;
<a name="l00108"></a>00108   <a class="code" href="a00025.html#3643b1cbe7f1d5819b849e943d454acc">fap_ch_tab_idx_rx</a>=0;
<a name="l00109"></a>00109   <a class="code" href="a00025.html#82997674dcc4273bf292fd681ec199a7">fap_hold_rx_channel</a>=0;
<a name="l00110"></a>00110   <a class="code" href="a00025.html#c05ef73eb0018ffdbc75f4dda3b68258">fap_timer_period</a>=0; 
<a name="l00111"></a>00111   <a class="code" href="a00025.html#ef1fae944bed2970c1f1d41cb7843f04">fap_rx_channel_guess</a> = 0; 
<a name="l00112"></a>00112   
<a name="l00113"></a>00113   <span class="comment">// Default setup that later may be altered by application</span>
<a name="l00114"></a>00114   <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b8625cc7129d0e8049f1061d323a52535">FAP_PDOWN_IDLE_EN</a>);
<a name="l00115"></a>00115   <a class="code" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b6f11fadf5d6a6de810c7bb73ebd5e4c7">FAP_LP_RX_EN</a>);
<a name="l00116"></a>00116   <a class="code" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b5a9539514e56b772a2c2049e8acc0708">FAP_CH_SYNC_EN</a>);
<a name="l00117"></a>00117   <a class="code" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>);
<a name="l00118"></a>00118   <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b3b65e04ae72d05978f8f3fb5d1fe5b58">FAP_TX_SUCCESS</a>);
<a name="l00119"></a>00119 
<a name="l00120"></a>00120   <span class="comment">// Default static setup</span>
<a name="l00121"></a>00121   <a class="code" href="a00030.html#a23954cf1f404b7fefa20a9d1938453f">hal_nrf_set_datarate</a>(<a class="code" href="a00067.html#g504b0e4d90c7a7fe1ee0c7ede28b0108">FAP_DATARATE</a>);    
<a name="l00122"></a>00122   <a class="code" href="a00030.html#3dafb8f75609071d396e3934e42a2547">hal_nrf_set_auto_retr</a>(<a class="code" href="a00059.html#099a76c5ef26c4751ee6f0516aa4b37c">FAP_NRF_AUTO_RETRIES</a>, <a class="code" href="a00067.html#g66b26d1ad669c2a00dcd1c14cca1b4fd">FAP_AUTO_RETR_DELAY</a>); 
<a name="l00123"></a>00123   <a class="code" href="a00030.html#21236deff13ec979d07f3034a6fe4960">hal_nrf_set_output_power</a>(<a class="code" href="a00067.html#g759c414b7ea0db9dd71a9c038f563ff7">FAP_OUTPUT_POWER</a>); 
<a name="l00124"></a>00124   <a class="code" href="a00030.html#005968b130c020935d0540234f38a993">hal_nrf_set_crc_mode</a>(<a class="code" href="a00067.html#g85aa952d9f8de7690706a55b0c5c3cdd">FAP_CRC</a>);   
<a name="l00125"></a>00125   <a class="code" href="a00030.html#1e29d504df3a94f370341218a5cfc79d">hal_nrf_set_address_width</a>(<a class="code" href="a00067.html#gdb62d8340e7516d09c3427f436a62fb3">FAP_ADDRESS_WIDTH</a>);
<a name="l00126"></a>00126   
<a name="l00127"></a>00127   <a class="code" href="a00030.html#c91c771ac6ea1910a50ecb83ec63b4eb">hal_nrf_get_clear_irq_flags</a>();
<a name="l00128"></a>00128   
<a name="l00129"></a>00129   <a class="code" href="a00030.html#d578f0da2551eea2b0a6d725e329101d">hal_nrf_flush_rx</a>();
<a name="l00130"></a>00130   <a class="code" href="a00030.html#7b78e68c0d96859d77df776fbb1cb247">hal_nrf_flush_tx</a>();
<a name="l00131"></a>00131   
<a name="l00132"></a>00132   <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00133"></a>00133 }  
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="a00067_g98096286b36e9d7f8df7c9c733b10e5a_cgraph.png" border="0" usemap="#a00067_g98096286b36e9d7f8df7c9c733b10e5a_cgraph_map" alt=""></center>
<map name="a00067_g98096286b36e9d7f8df7c9c733b10e5a_cgraph_map">
<area href="a00029.html#879863f7f7be332410d790b5cbb2c912" shape="rect" coords="121,5,260,32" alt="">
<area href="a00043.html#48058f0d26bed0107d1f0141b557ad8b" shape="rect" coords="311,5,369,32" alt="">
</map>

<p>
Here is the caller graph for this function:<p><center><img src="a00067_g98096286b36e9d7f8df7c9c733b10e5a_icgraph.png" border="0" usemap="#a00067_g98096286b36e9d7f8df7c9c733b10e5a_icgraph_map" alt=""></center>
<map name="a00067_g98096286b36e9d7f8df7c9c733b10e5a_icgraph_map">
<area href="a00019.html#cca4b6216b3be1e1db321a93436d004d" shape="rect" coords="132,5,223,32" alt="">
<area href="a00019.html#d8b13fae75396c1142b12e8400bf8282" shape="rect" coords="120,56,235,83" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="gaed36c5567ef853d863244f3c8ef85ad"></a><!-- doxytag: member="fap.h::fap_set_address" ref="gaed36c5567ef853d863244f3c8ef85ad" args="(U8 dev, U8 *adr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fap_set_address           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a>&nbsp;</td>
          <td class="paramname"> <em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> *&nbsp;</td>
          <td class="paramname"> <em>adr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for setting the explicit receive address for a given pipe. 
<p>
The radio can monitor up to 6 addresses (pipes) simultaneously. The addresses for pipe 0 and 1 are specified using 5 bytes, while the address for pipe 2-5 are specified using a 1 byte address. This 1 byte address specifies the LSByte address whilst the remaining address bytes for these pipes will equal those for pipe 1.<p>
Note that the FAP must be in IDLE mode in order for this function to have any effect.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dev</em>&nbsp;</td><td>specifies the pipe number (0-5) for which to set the address.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>adr</em>&nbsp;</td><td>is a pointer to the address to be used for the given pipe. This address is copied and stored in the radio hardware, thus the address does not need to reside on this location during receive.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd></dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>false</em>&nbsp;</td><td>if failure due to the FAP not beeing in IDLE prior to function call. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>success.</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="a00067.html#gec543eeacba621d36cc71eb399a084aa">fap_rx_data()</a>, <a class="el" href="a00067.html#ge6147d552537f3b74c7251af34041a35">fap_tx_data()</a>, <a class="el" href="a00067.html#g265d0918166f0231f7f87e50005057bb">fap_goto_idle_mode()</a> </dd></dl>

<p>
&lt; select pipe 0 
<p>
Definition at line <a class="el" href="a00094.html#l00145">145</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00095.html#l00040">FAP_ADDRESS_WIDTH</a>, <a class="el" href="a00094.html#l00045">fap_curr_tx_setup</a>, <a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2">FAP_IDLE</a>, <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, <a class="el" href="a00094.html#l00073">fap_mode</a>, <a class="el" href="a00094.html#l00044">fap_p0_adr</a>, <a class="el" href="a00099.html#l00067">HAL_NRF_PIPE0</a>, and <a class="el" href="a00098.html#l00112">hal_nrf_set_address()</a>.<div class="fragment"><pre class="fragment"><a name="l00146"></a>00146 { 
<a name="l00147"></a>00147   <span class="keywordflow">if</span>(<a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a>==<a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2">FAP_IDLE</a>)
<a name="l00148"></a>00148   {
<a name="l00149"></a>00149     <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00150"></a>00150   
<a name="l00151"></a>00151     <a class="code" href="a00025.html#5f5d4f3ec65eec85c2354c20ca3266b4">fap_curr_tx_setup</a> = 0xff;
<a name="l00152"></a>00152   
<a name="l00153"></a>00153     <span class="keywordflow">if</span>(dev == <a class="code" href="a00030.html#41987623eab14c90171466953e5569e0">HAL_NRF_PIPE0</a>)
<a name="l00154"></a>00154     {
<a name="l00155"></a>00155       memcpy(<a class="code" href="a00025.html#ca0a0f73d5998b5fbf60bd9e01ebbad9">fap_p0_adr</a>, adr, <a class="code" href="a00067.html#gdb62d8340e7516d09c3427f436a62fb3">FAP_ADDRESS_WIDTH</a>);
<a name="l00156"></a>00156     } 
<a name="l00157"></a>00157     <a class="code" href="a00029.html#4529776acbd4170ce057e4fa678a1889">hal_nrf_set_address</a>(dev, adr);
<a name="l00158"></a>00158     
<a name="l00159"></a>00159     <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00160"></a>00160    
<a name="l00161"></a>00161     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00162"></a>00162   }
<a name="l00163"></a>00163   <span class="keywordflow">else</span>
<a name="l00164"></a>00164   {
<a name="l00165"></a>00165     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00166"></a>00166   }
<a name="l00167"></a>00167 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="a00067_gaed36c5567ef853d863244f3c8ef85ad_cgraph.png" border="0" usemap="#a00067_gaed36c5567ef853d863244f3c8ef85ad_cgraph_map" alt=""></center>
<map name="a00067_gaed36c5567ef853d863244f3c8ef85ad_cgraph_map">
<area href="a00029.html#4529776acbd4170ce057e4fa678a1889" shape="rect" coords="178,5,319,32" alt="">
<area href="a00035.html#9856ea5a03c048d29e4670d94a87f51f" shape="rect" coords="370,5,479,32" alt="">
<area href="a00043.html#48058f0d26bed0107d1f0141b557ad8b" shape="rect" coords="530,5,588,32" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="gb108b5cbcc502e40c0dc587014ac3086"></a><!-- doxytag: member="fap.h::fap_get_address" ref="gb108b5cbcc502e40c0dc587014ac3086" args="(U8 dev, U8 *adr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fap_get_address           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a>&nbsp;</td>
          <td class="paramname"> <em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> *&nbsp;</td>
          <td class="paramname"> <em>adr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for reading the address set for a given pipe. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dev</em>&nbsp;</td><td>specifies the pipe number(0-5) for which to get the address.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>adr</em>&nbsp;</td><td>is a pointer to where the address shall be written. For pipe 1-2 5 bytes are returned, whilst for the remaining pipes a single byte is returned.</td></tr>
  </table>
</dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="a00067.html#gaed36c5567ef853d863244f3c8ef85ad">fap_set_address()</a> </dd></dl>

<p>
Definition at line <a class="el" href="a00094.html#l00169">169</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, and <a class="el" href="a00098.html#l00091">hal_nrf_get_address()</a>.<div class="fragment"><pre class="fragment"><a name="l00170"></a>00170 {
<a name="l00171"></a>00171   <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00172"></a>00172 
<a name="l00173"></a>00173   <a class="code" href="a00029.html#16eb6527705c9e8c6d9144f0bcf4bcd4">hal_nrf_get_address</a>(dev, adr);
<a name="l00174"></a>00174     
<a name="l00175"></a>00175   <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00176"></a>00176 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="a00067_gb108b5cbcc502e40c0dc587014ac3086_cgraph.png" border="0" usemap="#a00067_gb108b5cbcc502e40c0dc587014ac3086_cgraph_map" alt=""></center>
<map name="a00067_gb108b5cbcc502e40c0dc587014ac3086_cgraph_map">
<area href="a00029.html#16eb6527705c9e8c6d9144f0bcf4bcd4" shape="rect" coords="176,5,320,32" alt="">
<area href="a00035.html#82238ef5299abf89313c36ac94c7ee89" shape="rect" coords="368,5,477,32" alt="">
<area href="a00043.html#48058f0d26bed0107d1f0141b557ad8b" shape="rect" coords="527,5,585,32" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="ga1e5eeb464c145ed6ce040e07cda1313"></a><!-- doxytag: member="fap.h::fap_set_channels" ref="ga1e5eeb464c145ed6ce040e07cda1313" args="(U8 *channels)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fap_set_channels           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> *&nbsp;</td>
          <td class="paramname"> <em>channels</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for setting up the subset of channels to be used by the FAP. 
<p>
Note that the receiver and the transmitter must be set up using the same subset of channels. The number of channels to be used is specified by the constant FAP_CH_TAB_SIZE in <a class="el" href="a00028.html">fap_setup.h</a>.<p>
It is recommended that the selected channels are distributed over a wide frequency range. The possible channel range for nRF24L01 is 0 to 123.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>channels</em>&nbsp;</td><td>is a pointer to an array holding the FAP_CH_TAB_SIZE number of channels to be used. </td></tr>
  </table>
</dl>

<p>
&lt; Sets the frequency channel (0 to 123) 
<p>
Definition at line <a class="el" href="a00094.html#l00135">135</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00094.html#l00042">fap_ch_tab</a>, <a class="el" href="a00094.html#l00076">fap_ch_tab_idx_tx</a>, <a class="el" href="a00128.html#l00128">FAP_CH_TAB_SIZE</a>, <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, and <a class="el" href="a00099.html#l00114">hal_nrf_set_rf_channel</a>.
<p>
Referenced by <a class="el" href="a00088.html#l00135">cdc_rf_task()</a>, and <a class="el" href="a00088.html#l00099">cdc_rf_task_init()</a>.<div class="fragment"><pre class="fragment"><a name="l00136"></a>00136 {
<a name="l00137"></a>00137   <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00138"></a>00138 
<a name="l00139"></a>00139   memcpy(<a class="code" href="a00025.html#47208fa4ba15fee8caab858a70381a77">fap_ch_tab</a>, channels, <a class="code" href="a00059.html#aa26657c26f5abafd448320a4e45983d">FAP_CH_TAB_SIZE</a>);
<a name="l00140"></a>00140   <a class="code" href="a00030.html#887c567677a6475cef9b55089918ee7b">hal_nrf_set_rf_channel</a>(<a class="code" href="a00025.html#47208fa4ba15fee8caab858a70381a77">fap_ch_tab</a>[<a class="code" href="a00025.html#d15e0b7d57aef8a352b93df6511342cb">fap_ch_tab_idx_tx</a>]); 
<a name="l00141"></a>00141 
<a name="l00142"></a>00142   <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00143"></a>00143 }
</pre></div>
<p>

<p>
Here is the caller graph for this function:<p><center><img src="a00067_ga1e5eeb464c145ed6ce040e07cda1313_icgraph.png" border="0" usemap="#a00067_ga1e5eeb464c145ed6ce040e07cda1313_icgraph_map" alt=""></center>
<map name="a00067_ga1e5eeb464c145ed6ce040e07cda1313_icgraph_map">
<area href="a00019.html#cca4b6216b3be1e1db321a93436d004d" shape="rect" coords="193,5,284,32" alt="">
<area href="a00019.html#d8b13fae75396c1142b12e8400bf8282" shape="rect" coords="181,56,296,83" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="g8460a9f7f7014d96a9f5126a7e2b2fe4"></a><!-- doxytag: member="fap.h::fap_select_radio_idle_mode" ref="g8460a9f7f7014d96a9f5126a7e2b2fe4" args="(fap_radio_idle_modes_t mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fap_select_radio_idle_mode           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00067.html#g155eee989362c6cdac1f164dea1b714c">fap_radio_idle_modes_t</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for selecting in which mode the radio shall reside when the FAP is in IDLE mode. 
<p>
The nRF radio may reside in two different modes when not transmitting or receiving (FAP IDLE), which are STANDBY or POWER DOWN, respectively. In STANDBY the radio consumes more power than in POWER DOWN, but the radio start-up time is shorter, which will result in a lower transmit latency when starting a new transmit operation. When the radio resides in power down one must account for an increased latency of typically 1.5 ms.<p>
The FAP must be in IDLE mode in order for this function to have any effect.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>selects the radio mode. Possible arguments are: <ul>
<li><code>FAP_PDOWN_IDLE</code> </li>
<li><code>FAP_STANDBY_IDLE</code> </li>
</ul>
</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd></dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>false</em>&nbsp;</td><td>if failure due to the FAP not being in IDLE prior to function call. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>true</em>&nbsp;</td><td>if function executed successfully. </td></tr>
  </table>
</dl>

<p>
&lt; tranceiver power down<p>
&lt; Wake(1) or Shutdown(0) the tranceiver<p>
&lt; tranceiver power up<p>
&lt; Wake(1) or Shutdown(0) the tranceiver 
<p>
Definition at line <a class="el" href="a00094.html#l00417">417</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00095.html#l00062">FAP_CLEAR_BIT</a>, <a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2">FAP_IDLE</a>, <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, <a class="el" href="a00094.html#l00073">fap_mode</a>, <a class="el" href="a00067.html#gg155eee989362c6cdac1f164dea1b714c9352df39fbc375a503d6826b4a69bbec">FAP_PDOWN_IDLE</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b8625cc7129d0e8049f1061d323a52535">FAP_PDOWN_IDLE_EN</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>, <a class="el" href="a00095.html#l00063">FAP_SET_BIT</a>, <a class="el" href="a00094.html#l00065">fap_status</a>, <a class="el" href="a00099.html#l00065">HAL_NRF_PWR_DOWN</a>, <a class="el" href="a00099.html#l00066">HAL_NRF_PWR_UP</a>, and <a class="el" href="a00099.html#l00116">hal_nrf_set_power_mode</a>.
<p>
Referenced by <a class="el" href="a00088.html#l00135">cdc_rf_task()</a>, and <a class="el" href="a00088.html#l00099">cdc_rf_task_init()</a>.<div class="fragment"><pre class="fragment"><a name="l00418"></a>00418 {
<a name="l00419"></a>00419   <span class="keywordflow">if</span>(<a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a>==<a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2">FAP_IDLE</a>)
<a name="l00420"></a>00420   {
<a name="l00421"></a>00421     <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00422"></a>00422  
<a name="l00423"></a>00423     <span class="keywordflow">if</span>(mode == <a class="code" href="a00067.html#gg155eee989362c6cdac1f164dea1b714c9352df39fbc375a503d6826b4a69bbec">FAP_PDOWN_IDLE</a>)
<a name="l00424"></a>00424     {
<a name="l00425"></a>00425       <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b8625cc7129d0e8049f1061d323a52535">FAP_PDOWN_IDLE_EN</a>);
<a name="l00426"></a>00426   
<a name="l00427"></a>00427       <span class="keywordflow">if</span>(<a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a>==<a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2">FAP_IDLE</a>)
<a name="l00428"></a>00428       {
<a name="l00429"></a>00429         <a class="code" href="a00030.html#3334b75f295de730325aeb0ab47b471a">hal_nrf_set_power_mode</a>(<a class="code" href="a00030.html#4683c4ed43fd24aa5680133eae96cbdb">HAL_NRF_PWR_DOWN</a>);
<a name="l00430"></a>00430         <a class="code" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>);
<a name="l00431"></a>00431       }
<a name="l00432"></a>00432     }
<a name="l00433"></a>00433     <span class="keywordflow">else</span>
<a name="l00434"></a>00434     {
<a name="l00435"></a>00435       <a class="code" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b8625cc7129d0e8049f1061d323a52535">FAP_PDOWN_IDLE_EN</a>);  
<a name="l00436"></a>00436     
<a name="l00437"></a>00437       <span class="comment">// Update radio power mode if FAP is in idle mode</span>
<a name="l00438"></a>00438       <a class="code" href="a00030.html#3334b75f295de730325aeb0ab47b471a">hal_nrf_set_power_mode</a>(<a class="code" href="a00030.html#c4d45d9ed6219f65866b090cd84543e4">HAL_NRF_PWR_UP</a>);
<a name="l00439"></a>00439       <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>);
<a name="l00440"></a>00440     }
<a name="l00441"></a>00441     
<a name="l00442"></a>00442     <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00443"></a>00443     
<a name="l00444"></a>00444     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00445"></a>00445   }
<a name="l00446"></a>00446   <span class="keywordflow">else</span>
<a name="l00447"></a>00447   {
<a name="l00448"></a>00448     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00449"></a>00449   }
<a name="l00450"></a>00450 }
</pre></div>
<p>

<p>
Here is the caller graph for this function:<p><center><img src="a00067_g8460a9f7f7014d96a9f5126a7e2b2fe4_icgraph.png" border="0" usemap="#a00067_g8460a9f7f7014d96a9f5126a7e2b2fe4_icgraph_map" alt=""></center>
<map name="a00067_g8460a9f7f7014d96a9f5126a7e2b2fe4_icgraph_map">
<area href="a00019.html#cca4b6216b3be1e1db321a93436d004d" shape="rect" coords="255,5,346,32" alt="">
<area href="a00019.html#d8b13fae75396c1142b12e8400bf8282" shape="rect" coords="243,56,358,83" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="g265d0918166f0231f7f87e50005057bb"></a><!-- doxytag: member="fap.h::fap_goto_idle_mode" ref="g265d0918166f0231f7f87e50005057bb" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fap_goto_idle_mode           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for forcing the FAP to IDLE mode. 
<p>
The FAP have three different operation modes; TRANSMITTING, RECEIVING or IDLE, respectively. When the FAP is receiving or transmitting it may automatically return to IDLE mode after a specified timeout period, or in TRANSMIT mode also after transmission success.<p>
In addition, this function can be ysed to immediately force the FAP to IDLE mode. 
<p>
Definition at line <a class="el" href="a00094.html#l00694">694</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00095.html#l00062">FAP_CLEAR_BIT</a>, <a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2">FAP_IDLE</a>, <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, <a class="el" href="a00094.html#l00068">fap_latency_counter</a>, <a class="el" href="a00094.html#l00073">fap_mode</a>, <a class="el" href="a00094.html#l00065">fap_status</a>, and <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b671d3bd25264460673bc79b7405ce414">FAP_TX_RX_INFINITE_TIMEOUT_EN</a>.
<p>
Referenced by <a class="el" href="a00088.html#l00135">cdc_rf_task()</a>, <a class="el" href="a00088.html#l00099">cdc_rf_task_init()</a>, <a class="el" href="a00094.html#l00178">fap_rx_data()</a>, and <a class="el" href="a00094.html#l00241">fap_tx_data()</a>.<div class="fragment"><pre class="fragment"><a name="l00695"></a>00695 {
<a name="l00696"></a>00696   <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00697"></a>00697 
<a name="l00698"></a>00698   <a class="code" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b671d3bd25264460673bc79b7405ce414">FAP_TX_RX_INFINITE_TIMEOUT_EN</a>);
<a name="l00699"></a>00699   
<a name="l00700"></a>00700   <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00701"></a>00701 
<a name="l00702"></a>00702   <a class="code" href="a00025.html#fac0a12b2c8ed9ae94fa2cbc6ab17ed1">fap_latency_counter</a>=0; 
<a name="l00703"></a>00703   <span class="keywordflow">while</span>(<a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a>!=<a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2">FAP_IDLE</a>);
<a name="l00704"></a>00704 }
</pre></div>
<p>

<p>
Here is the caller graph for this function:<p><center><img src="a00067_g265d0918166f0231f7f87e50005057bb_icgraph.png" border="0" usemap="#a00067_g265d0918166f0231f7f87e50005057bb_icgraph_map" alt=""></center>
<map name="a00067_g265d0918166f0231f7f87e50005057bb_icgraph_map">
<area href="a00019.html#cca4b6216b3be1e1db321a93436d004d" shape="rect" coords="351,56,442,83" alt="">
<area href="a00019.html#d8b13fae75396c1142b12e8400bf8282" shape="rect" coords="339,132,454,159" alt="">
<area href="a00067.html#gec543eeacba621d36cc71eb399a084aa" shape="rect" coords="198,107,291,133" alt="">
<area href="a00067.html#ge6147d552537f3b74c7251af34041a35" shape="rect" coords="198,56,291,83" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="gd39f595cbc496278f6064561649200c0"></a><!-- doxytag: member="fap.h::fap_get_mode" ref="gd39f595cbc496278f6064561649200c0" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00067.html#ge9ac64bf8d27b84d9ceede9028c86978">fap_modes_t</a> fap_get_mode           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for observing the current FAP mode. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns the current the FAP mode. </dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>FAP_IDLE</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FAP_TRANSMITTING</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FAP_RECEIVING</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="a00067.html#gec543eeacba621d36cc71eb399a084aa">fap_rx_data()</a>, <a class="el" href="a00067.html#ge6147d552537f3b74c7251af34041a35">fap_tx_data()</a>, <a class="el" href="a00067.html#g265d0918166f0231f7f87e50005057bb">fap_goto_idle_mode()</a> </dd></dl>

<p>
Definition at line <a class="el" href="a00094.html#l00382">382</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00094.html#l00073">fap_mode</a>.
<p>
Referenced by <a class="el" href="a00088.html#l00135">cdc_rf_task()</a>.<div class="fragment"><pre class="fragment"><a name="l00383"></a>00383 {
<a name="l00384"></a>00384   <span class="keywordflow">return</span> <a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a>;
<a name="l00385"></a>00385 }
</pre></div>
<p>

<p>
Here is the caller graph for this function:<p><center><img src="a00067_gd39f595cbc496278f6064561649200c0_icgraph.png" border="0" usemap="#a00067_gd39f595cbc496278f6064561649200c0_icgraph_map" alt=""></center>
<map name="a00067_gd39f595cbc496278f6064561649200c0_icgraph_map">
<area href="a00019.html#cca4b6216b3be1e1db321a93436d004d" shape="rect" coords="163,5,254,32" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="ge6147d552537f3b74c7251af34041a35"></a><!-- doxytag: member="fap.h::fap_tx_data" ref="ge6147d552537f3b74c7251af34041a35" args="(fap_tx_rx_struct_t *datainput, U16 tx_timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fap_tx_data           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00001.html">fap_tx_rx_struct_t</a> *&nbsp;</td>
          <td class="paramname"> <em>datainput</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html#df928e51a60dba0df29d615401cc55a8">U16</a>&nbsp;</td>
          <td class="paramname"> <em>tx_timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for transmitting data. 
<p>
This function transmits the data provided in the <b>pl</b> field of the input data structure *datainput to the destination given by the <b>pipe</b> field. The actual TX address to be used is setup using the function <a class="el" href="a00067.html#gaed36c5567ef853d863244f3c8ef85ad">fap_set_address()</a>.<p>
When the data is successfully transmitted the FAP will automatically return to IDLE mode. In addition it may be specified a maximum timeout period the FAP shall try to transmit data before returning to IDLE mode.<p>
It is not required for the FAP to be in IDLE mode before issuing this function. It is possible to upload new data to the TX FIFO during an ongoing transmission. The data uploaded to the TX FIFO will immediately be transmitted when the ongoing transmission is completed, thus enabling a streaming type of operation. However, in order to upload TX data during an ongoing transmission, the following criteria must be fulfilled:<p>
<ul>
<li>Channel synchronization must be disabled by <a class="el" href="a00067.html#g9d5d854b0084d2bad76bd6730acbbc68">fap_ch_sync_enable()</a>.</li><li>The destination for the uploaded data must be the same as for the ongoing transmission.</li><li>The TX FIFO cannot be full. The TX FIFO can hold up to 3 payloads.</li><li>The transmit timeout specified must be the same as for the ongoing transmission.</li></ul>
<p>
If the FAP is in RECEIVE mode when issuing this function, the FAP will automatically enter TRANSMIT mode. After completion the FAP will always go to IDLE mode.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*datainput</em>&nbsp;</td><td>[in] is a pointer to a structure containing the payload to be transmitted, the payload length and the transmit destination.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tx_timeout</em>&nbsp;</td><td>specifies the maximum period the FAP shall attempt to transmit before returning to IDLE mode. The maximum timeout period will equal transmit_timeout*FAP_MAX_TX_PERIOD [us]. An infinite transmit period may be specified by setting this parameter to 0.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns whether the data was successfully handed to the FAP for transmission. </dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>true</em>&nbsp;</td><td>if data successfully handed to FAP. The data will be attempted transmitted by the FAP. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>false</em>&nbsp;</td><td>if data were not successfully handed to the FAP due to one or more of the required criteria not fulfilled. Any ongoing FAP operation is not affected and the FAP mode remains the same as before the function was called.</td></tr>
  </table>
</dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="a00067.html#gd39f595cbc496278f6064561649200c0">fap_get_mode()</a>, <a class="el" href="a00067.html#gaed36c5567ef853d863244f3c8ef85ad">fap_set_address()</a>, <a class="el" href="a00067.html#g83d37651028ee29a9f78d61839dffac8">fap_tx_success()</a>, <a class="el" href="a00067.html#g265d0918166f0231f7f87e50005057bb">fap_goto_idle_mode(void)</a>, <a class="el" href="a00067.html#gadbeb049d5ccbd2a7f3ec49cc0792e4c">fap_ch_sync_disable()</a>. </dd></dl>

<p>
&lt; transmitter mode<p>
&lt; puts the tranceiver into transmitter(0) or receiver(1)<p>
&lt; select pipe 0<p>
&lt; Open selected pipe (pipe: 0~5, AutoAck: 0/1)<p>
&lt; select pipe 0<p>
&lt; Refer to TX address<p>
&lt; select pipe 0<p>
&lt; select pipe 1<p>
&lt; select pipe 1<p>
&lt; select pipe 2<p>
&lt; select pipe 2<p>
&lt; select pipe 3<p>
&lt; select pipe 3<p>
&lt; select pipe 4<p>
&lt; select pipe 4<p>
&lt; select pipe 5<p>
&lt; select pipe 5<p>
&lt; select pipe 0<p>
&lt; Refer to TX address<p>
&lt; flushs the tx buffer<p>
&lt; Writes the contents of tx payload<p>
&lt; Enables the tranceiver<p>
&lt; tranceiver power up<p>
&lt; Wake(1) or Shutdown(0) the tranceiver<p>
&lt; Returns true if tx fifo is full<p>
&lt; Writes the contents of tx payload 
<p>
Definition at line <a class="el" href="a00094.html#l00241">241</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00099.html#l00100">CE_HIGH</a>, <a class="el" href="a00105.html#l00107">EN_AA</a>, <a class="el" href="a00094.html#l00081">fap_ch_switch_counter</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b5a9539514e56b772a2c2049e8acc0708">FAP_CH_SYNC_EN</a>, <a class="el" href="a00095.html#l00062">FAP_CLEAR_BIT</a>, <a class="el" href="a00094.html#l00045">fap_curr_tx_setup</a>, <a class="el" href="a00095.html#l00184">FAP_DEVICE0</a>, <a class="el" href="a00095.html#l00185">FAP_DEVICE1</a>, <a class="el" href="a00095.html#l00186">FAP_DEVICE2</a>, <a class="el" href="a00095.html#l00187">FAP_DEVICE3</a>, <a class="el" href="a00095.html#l00188">FAP_DEVICE4</a>, <a class="el" href="a00095.html#l00189">FAP_DEVICE5</a>, <a class="el" href="a00094.html#l00048">fap_general_buffer</a>, <a class="el" href="a00095.html#l00061">FAP_GET_BIT</a>, <a class="el" href="a00094.html#l00694">fap_goto_idle_mode()</a>, <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, <a class="el" href="a00094.html#l00068">fap_latency_counter</a>, <a class="el" href="a00094.html#l00068">fap_latency_setup</a>, <a class="el" href="a00128.html#l00161">FAP_MAX_FW_PL_LENGTH</a>, <a class="el" href="a00094.html#l00073">fap_mode</a>, <a class="el" href="a00094.html#l00044">fap_p0_adr</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>, <a class="el" href="a00095.html#l00073">FAP_RADIO_PWR_UP_DELAY</a>, <a class="el" href="a00094.html#l00067">fap_radio_startup_counter</a>, <a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697867e95ead0704559b85e6193170e13392">FAP_RECEIVING</a>, <a class="el" href="a00094.html#l00069">fap_retry_extend_counter</a>, <a class="el" href="a00095.html#l00063">FAP_SET_BIT</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b75787cc22817c3d5028085ce0b8cb56f">FAP_START_NEW_TX</a>, <a class="el" href="a00094.html#l00065">fap_status</a>, <a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c869789c4a1edf3ad50e19eaf13e1d7892cc2f">FAP_TRANSMITTING</a>, <a class="el" href="a00094.html#l00071">fap_try_counter</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b671d3bd25264460673bc79b7405ce414">FAP_TX_RX_INFINITE_TIMEOUT_EN</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b3b65e04ae72d05978f8f3fb5d1fe5b58">FAP_TX_SUCCESS</a>, <a class="el" href="a00099.html#l00111">hal_nrf_flush_tx</a>, <a class="el" href="a00098.html#l00091">hal_nrf_get_address()</a>, <a class="el" href="a00099.html#l00122">hal_nrf_open_pipe</a>, <a class="el" href="a00099.html#l00067">HAL_NRF_PIPE0</a>, <a class="el" href="a00099.html#l00068">HAL_NRF_PIPE1</a>, <a class="el" href="a00099.html#l00069">HAL_NRF_PIPE2</a>, <a class="el" href="a00099.html#l00070">HAL_NRF_PIPE3</a>, <a class="el" href="a00099.html#l00071">HAL_NRF_PIPE4</a>, <a class="el" href="a00099.html#l00072">HAL_NRF_PIPE5</a>, <a class="el" href="a00099.html#l00075">HAL_NRF_PTX</a>, <a class="el" href="a00099.html#l00066">HAL_NRF_PWR_UP</a>, <a class="el" href="a00098.html#l00112">hal_nrf_set_address()</a>, <a class="el" href="a00099.html#l00117">hal_nrf_set_operation_mode</a>, <a class="el" href="a00099.html#l00116">hal_nrf_set_power_mode</a>, <a class="el" href="a00099.html#l00073">HAL_NRF_TX</a>, <a class="el" href="a00099.html#l00137">hal_nrf_tx_fifo_full</a>, <a class="el" href="a00099.html#l00109">hal_nrf_write_tx_pload</a>, and <a class="el" href="a00095.html#l00149">fap_tx_rx_struct_t::pl</a>.
<p>
Referenced by <a class="el" href="a00088.html#l00135">cdc_rf_task()</a>.<div class="fragment"><pre class="fragment"><a name="l00242"></a>00242 {
<a name="l00243"></a>00243 
<a name="l00244"></a>00244   <span class="keywordflow">if</span>(datainput -&gt; pl_length &gt; <a class="code" href="a00059.html#961d8cded4a02018bc0737f3bed08ce0">FAP_MAX_FW_PL_LENGTH</a>)
<a name="l00245"></a>00245   {
<a name="l00246"></a>00246     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00247"></a>00247   }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249   <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00250"></a>00250 
<a name="l00251"></a>00251   <span class="keywordflow">if</span>(<a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a> != <a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c869789c4a1edf3ad50e19eaf13e1d7892cc2f">FAP_TRANSMITTING</a>)              <span class="comment">// Thus IDLE or RECEIVING</span>
<a name="l00252"></a>00252   {
<a name="l00253"></a>00253     <span class="keywordflow">if</span>(<a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a> == <a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697867e95ead0704559b85e6193170e13392">FAP_RECEIVING</a>)
<a name="l00254"></a>00254     {
<a name="l00255"></a>00255       <a class="code" href="a00067.html#g265d0918166f0231f7f87e50005057bb">fap_goto_idle_mode</a>();  
<a name="l00256"></a>00256     }
<a name="l00257"></a>00257    
<a name="l00258"></a>00258     <span class="comment">// If TX setup modified</span>
<a name="l00259"></a>00259     <span class="keywordflow">if</span>(<a class="code" href="a00025.html#5f5d4f3ec65eec85c2354c20ca3266b4">fap_curr_tx_setup</a> != (datainput -&gt; pipe))
<a name="l00260"></a>00260     {  
<a name="l00261"></a>00261       <a class="code" href="a00030.html#264459a33aebd0f37e88642486e506dd">hal_nrf_set_operation_mode</a>(<a class="code" href="a00030.html#b8e82071759222570939b742a5c862a4">HAL_NRF_PTX</a>);  
<a name="l00262"></a>00262       <a class="code" href="a00030.html#1861341afb8f3d19e375053c850fd540">hal_nrf_open_pipe</a>(<a class="code" href="a00030.html#41987623eab14c90171466953e5569e0">HAL_NRF_PIPE0</a>, <a class="code" href="a00036.html#a84a282351a2c9b83dd653df6ac59216">EN_AA</a>);
<a name="l00263"></a>00263   
<a name="l00264"></a>00264       <span class="keywordflow">if</span>(datainput -&gt; pipe == <a class="code" href="a00067.html#g7ab1bdd98125b9f7672e0d154fa9b83a">FAP_DEVICE0</a>)
<a name="l00265"></a>00265       {
<a name="l00266"></a>00266         <a class="code" href="a00029.html#4529776acbd4170ce057e4fa678a1889">hal_nrf_set_address</a>(<a class="code" href="a00030.html#a262d7f9c849c6ae96fcc515595c85de">HAL_NRF_TX</a>, <a class="code" href="a00025.html#ca0a0f73d5998b5fbf60bd9e01ebbad9">fap_p0_adr</a>);
<a name="l00267"></a>00267         <a class="code" href="a00029.html#4529776acbd4170ce057e4fa678a1889">hal_nrf_set_address</a>(<a class="code" href="a00030.html#41987623eab14c90171466953e5569e0">HAL_NRF_PIPE0</a>, <a class="code" href="a00025.html#ca0a0f73d5998b5fbf60bd9e01ebbad9">fap_p0_adr</a>);
<a name="l00268"></a>00268       }
<a name="l00269"></a>00269       <span class="keywordflow">else</span>
<a name="l00270"></a>00270       { 
<a name="l00271"></a>00271         <a class="code" href="a00029.html#16eb6527705c9e8c6d9144f0bcf4bcd4">hal_nrf_get_address</a>(<a class="code" href="a00030.html#9847e35660259f8ace9cd8aaf8e0b54e">HAL_NRF_PIPE1</a>, &amp;<a class="code" href="a00025.html#945da68a5bc9aed2bc1bf0600f0bc5a3">fap_general_buffer</a>.<a class="code" href="a00001.html#1b292c420a773f802a3910f03747e32c">pl</a>[0]);
<a name="l00272"></a>00272 
<a name="l00273"></a>00273         <span class="keywordflow">if</span>(datainput -&gt; pipe != <a class="code" href="a00067.html#g83cf56497c075f12367594efc2b8efb0">FAP_DEVICE1</a>)
<a name="l00274"></a>00274         {
<a name="l00275"></a>00275           <span class="keywordflow">switch</span>(datainput -&gt; pipe)
<a name="l00276"></a>00276           {
<a name="l00277"></a>00277             <span class="keywordflow">default</span>:
<a name="l00278"></a>00278             <span class="keywordflow">case</span> <a class="code" href="a00067.html#gcfcb9a90111343cbf97ad6fd4d0311e0">FAP_DEVICE2</a>:
<a name="l00279"></a>00279               <a class="code" href="a00029.html#16eb6527705c9e8c6d9144f0bcf4bcd4">hal_nrf_get_address</a>(<a class="code" href="a00030.html#fe9810240ae3c2abaee04e2e0ae87306">HAL_NRF_PIPE2</a>, &amp;<a class="code" href="a00025.html#945da68a5bc9aed2bc1bf0600f0bc5a3">fap_general_buffer</a>.<a class="code" href="a00001.html#1b292c420a773f802a3910f03747e32c">pl</a>[0]);          
<a name="l00280"></a>00280               <span class="keywordflow">break</span>;
<a name="l00281"></a>00281             <span class="keywordflow">case</span> <a class="code" href="a00067.html#g3a5462809ccfb31e2ab44a394d89652a">FAP_DEVICE3</a>:
<a name="l00282"></a>00282               <a class="code" href="a00029.html#16eb6527705c9e8c6d9144f0bcf4bcd4">hal_nrf_get_address</a>(<a class="code" href="a00030.html#9ab5c9e8afaaf0e0ef1f577fecd16f0b">HAL_NRF_PIPE3</a>, &amp;<a class="code" href="a00025.html#945da68a5bc9aed2bc1bf0600f0bc5a3">fap_general_buffer</a>.<a class="code" href="a00001.html#1b292c420a773f802a3910f03747e32c">pl</a>[0]);       
<a name="l00283"></a>00283               <span class="keywordflow">break</span>;
<a name="l00284"></a>00284             <span class="keywordflow">case</span> <a class="code" href="a00067.html#ge77847eda791daf86d3ad81ab885bf18">FAP_DEVICE4</a>:
<a name="l00285"></a>00285               <a class="code" href="a00029.html#16eb6527705c9e8c6d9144f0bcf4bcd4">hal_nrf_get_address</a>(<a class="code" href="a00030.html#255ca37d371e49b2fbc477d4979274ec">HAL_NRF_PIPE4</a>, &amp;<a class="code" href="a00025.html#945da68a5bc9aed2bc1bf0600f0bc5a3">fap_general_buffer</a>.<a class="code" href="a00001.html#1b292c420a773f802a3910f03747e32c">pl</a>[0]);
<a name="l00286"></a>00286               <span class="keywordflow">break</span>;
<a name="l00287"></a>00287             <span class="keywordflow">case</span> <a class="code" href="a00067.html#g4ec445eb93aea50b8f9b52f5f947c9f5">FAP_DEVICE5</a>:
<a name="l00288"></a>00288               <a class="code" href="a00029.html#16eb6527705c9e8c6d9144f0bcf4bcd4">hal_nrf_get_address</a>(<a class="code" href="a00030.html#b2fae25c533041b4318a4f2051bad915">HAL_NRF_PIPE5</a>, &amp;<a class="code" href="a00025.html#945da68a5bc9aed2bc1bf0600f0bc5a3">fap_general_buffer</a>.<a class="code" href="a00001.html#1b292c420a773f802a3910f03747e32c">pl</a>[0]);
<a name="l00289"></a>00289               <span class="keywordflow">break</span>;
<a name="l00290"></a>00290           }
<a name="l00291"></a>00291         }
<a name="l00292"></a>00292         <a class="code" href="a00029.html#4529776acbd4170ce057e4fa678a1889">hal_nrf_set_address</a>(<a class="code" href="a00030.html#41987623eab14c90171466953e5569e0">HAL_NRF_PIPE0</a>, &amp;<a class="code" href="a00025.html#945da68a5bc9aed2bc1bf0600f0bc5a3">fap_general_buffer</a>.<a class="code" href="a00001.html#1b292c420a773f802a3910f03747e32c">pl</a>[0]);
<a name="l00293"></a>00293         <a class="code" href="a00029.html#4529776acbd4170ce057e4fa678a1889">hal_nrf_set_address</a>(<a class="code" href="a00030.html#a262d7f9c849c6ae96fcc515595c85de">HAL_NRF_TX</a>, &amp;<a class="code" href="a00025.html#945da68a5bc9aed2bc1bf0600f0bc5a3">fap_general_buffer</a>.<a class="code" href="a00001.html#1b292c420a773f802a3910f03747e32c">pl</a>[0]);
<a name="l00294"></a>00294       }    
<a name="l00295"></a>00295       <a class="code" href="a00025.html#5f5d4f3ec65eec85c2354c20ca3266b4">fap_curr_tx_setup</a> = datainput -&gt; pipe;    
<a name="l00296"></a>00296     }
<a name="l00297"></a>00297     <a class="code" href="a00025.html#b23106c099ca8cf5dbf1f7dc6b8ce477">fap_ch_switch_counter</a>=0; 
<a name="l00298"></a>00298     <a class="code" href="a00025.html#a66224a1e157cc5bbdce726375dc0cb1">fap_retry_extend_counter</a>=0;
<a name="l00299"></a>00299     <a class="code" href="a00025.html#65a157ccfce63f4a73578b968ad1cdd7">fap_try_counter</a>=0;
<a name="l00300"></a>00300  
<a name="l00301"></a>00301     <span class="keywordflow">if</span>(tx_timeout==0)
<a name="l00302"></a>00302     {
<a name="l00303"></a>00303       <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b671d3bd25264460673bc79b7405ce414">FAP_TX_RX_INFINITE_TIMEOUT_EN</a>);
<a name="l00304"></a>00304     }
<a name="l00305"></a>00305     <span class="keywordflow">else</span>
<a name="l00306"></a>00306     {
<a name="l00307"></a>00307       <a class="code" href="a00025.html#fac0a12b2c8ed9ae94fa2cbc6ab17ed1">fap_latency_counter</a> = <a class="code" href="a00025.html#12e9db9d3d304ee12de2747eda102bee">fap_latency_setup</a> = tx_timeout;
<a name="l00308"></a>00308       <a class="code" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b671d3bd25264460673bc79b7405ce414">FAP_TX_RX_INFINITE_TIMEOUT_EN</a>);
<a name="l00309"></a>00309     }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311     <a class="code" href="a00030.html#7b78e68c0d96859d77df776fbb1cb247">hal_nrf_flush_tx</a>();
<a name="l00312"></a>00312     <a class="code" href="a00030.html#76d5fae13ba309253f4dea387ea72111">hal_nrf_write_tx_pload</a>(&amp;(datainput -&gt; pl[0]), datainput -&gt; pl_length);
<a name="l00313"></a>00313 
<a name="l00314"></a>00314     <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b3b65e04ae72d05978f8f3fb5d1fe5b58">FAP_TX_SUCCESS</a>);      <span class="comment">// Transmission by default "success"</span>
<a name="l00315"></a>00315   
<a name="l00316"></a>00316     <span class="keywordflow">if</span>(<a class="code" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>) &amp;&amp; !<a class="code" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b5a9539514e56b772a2c2049e8acc0708">FAP_CH_SYNC_EN</a>) )
<a name="l00317"></a>00317     {  
<a name="l00318"></a>00318       <a class="code" href="a00030.html#0b7419f0782729de0b8ffabffab8e995">CE_HIGH</a>();           
<a name="l00319"></a>00319     }
<a name="l00320"></a>00320     <span class="keywordflow">else</span>
<a name="l00321"></a>00321     {
<a name="l00322"></a>00322       <span class="keywordflow">if</span>(!<a class="code" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>))
<a name="l00323"></a>00323       {
<a name="l00324"></a>00324         <a class="code" href="a00030.html#3334b75f295de730325aeb0ab47b471a">hal_nrf_set_power_mode</a>(<a class="code" href="a00030.html#c4d45d9ed6219f65866b090cd84543e4">HAL_NRF_PWR_UP</a>);
<a name="l00325"></a>00325         <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>);
<a name="l00326"></a>00326         <a class="code" href="a00025.html#a83b88b5ab42840f8a5a64342be0d5ba">fap_radio_startup_counter</a> = <a class="code" href="a00067.html#g84b9c34cb03fefbee1372030b0ff6351">FAP_RADIO_PWR_UP_DELAY</a>;
<a name="l00327"></a>00327       }
<a name="l00328"></a>00328 
<a name="l00329"></a>00329       <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b75787cc22817c3d5028085ce0b8cb56f">FAP_START_NEW_TX</a>);
<a name="l00330"></a>00330     }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     <a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a>=<a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c869789c4a1edf3ad50e19eaf13e1d7892cc2f">FAP_TRANSMITTING</a>;
<a name="l00333"></a>00333     
<a name="l00334"></a>00334      <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00335"></a>00335      <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00336"></a>00336   } 
<a name="l00337"></a>00337   <span class="keywordflow">else</span> <span class="comment">// Check if criteria for starting new TX when in TX mode is fulfilled</span>
<a name="l00338"></a>00338   <span class="keywordflow">if</span>(!<a class="code" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b5a9539514e56b772a2c2049e8acc0708">FAP_CH_SYNC_EN</a>) &amp;&amp; \
<a name="l00339"></a>00339           <a class="code" href="a00025.html#5f5d4f3ec65eec85c2354c20ca3266b4">fap_curr_tx_setup</a> == (datainput -&gt; pipe) &amp;&amp; \
<a name="l00340"></a>00340           !<a class="code" href="a00030.html#084c8c90dae6a297d8253344b0fdcf5d">hal_nrf_tx_fifo_full</a>() &amp;&amp; \
<a name="l00341"></a>00341           tx_timeout == <a class="code" href="a00025.html#12e9db9d3d304ee12de2747eda102bee">fap_latency_setup</a> \
<a name="l00342"></a>00342   )       
<a name="l00343"></a>00343   {
<a name="l00344"></a>00344      <a class="code" href="a00030.html#76d5fae13ba309253f4dea387ea72111">hal_nrf_write_tx_pload</a>(&amp;(datainput -&gt; pl[0]), datainput -&gt; pl_length);
<a name="l00345"></a>00345 
<a name="l00346"></a>00346     <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00347"></a>00347     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00348"></a>00348   }
<a name="l00349"></a>00349   <span class="keywordflow">else</span>
<a name="l00350"></a>00350   {
<a name="l00351"></a>00351     <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00352"></a>00352     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00353"></a>00353   }
<a name="l00354"></a>00354 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="a00067_ge6147d552537f3b74c7251af34041a35_cgraph.png" border="0" usemap="#a00067_ge6147d552537f3b74c7251af34041a35_cgraph_map" alt=""></center>
<map name="a00067_ge6147d552537f3b74c7251af34041a35_cgraph_map">
<area href="a00067.html#g265d0918166f0231f7f87e50005057bb" shape="rect" coords="147,6,291,32" alt="">
<area href="a00029.html#16eb6527705c9e8c6d9144f0bcf4bcd4" shape="rect" coords="147,56,291,83" alt="">
<area href="a00029.html#4529776acbd4170ce057e4fa678a1889" shape="rect" coords="148,107,289,134" alt="">
<area href="a00035.html#82238ef5299abf89313c36ac94c7ee89" shape="rect" coords="340,56,449,83" alt="">
<area href="a00043.html#48058f0d26bed0107d1f0141b557ad8b" shape="rect" coords="500,82,559,108" alt="">
<area href="a00035.html#9856ea5a03c048d29e4670d94a87f51f" shape="rect" coords="340,107,449,134" alt="">
</map>

<p>
Here is the caller graph for this function:<p><center><img src="a00067_ge6147d552537f3b74c7251af34041a35_icgraph.png" border="0" usemap="#a00067_ge6147d552537f3b74c7251af34041a35_icgraph_map" alt=""></center>
<map name="a00067_ge6147d552537f3b74c7251af34041a35_icgraph_map">
<area href="a00019.html#cca4b6216b3be1e1db321a93436d004d" shape="rect" coords="147,5,238,32" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="ga4cb8971309f33217e1f0078ad1a3dc0"></a><!-- doxytag: member="fap.h::fap_flush_tx_fifo" ref="ga4cb8971309f33217e1f0078ad1a3dc0" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fap_flush_tx_fifo           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for flushing the hardware transmit FIFO. 
<p>
This yields any pending data in the TX FIFO, both normal device to host data, and host to device preloaded acknowledge data.<p>
It is recommended that the FAP is in IDLE mode whenever this function is called. 
<p>
&lt; flushs the tx buffer 
<p>
Definition at line <a class="el" href="a00094.html#l00356">356</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, and <a class="el" href="a00099.html#l00111">hal_nrf_flush_tx</a>.<div class="fragment"><pre class="fragment"><a name="l00357"></a>00357 {
<a name="l00358"></a>00358   <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00359"></a>00359 
<a name="l00360"></a>00360   <a class="code" href="a00030.html#7b78e68c0d96859d77df776fbb1cb247">hal_nrf_flush_tx</a>();
<a name="l00361"></a>00361 
<a name="l00362"></a>00362   <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00363"></a>00363 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g48fb01570bc2097b9edfa3a8812fa94d"></a><!-- doxytag: member="fap.h::fap_write_ack_pload" ref="g48fb01570bc2097b9edfa3a8812fa94d" args="(fap_tx_rx_struct_t *ackdata)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fap_write_ack_pload           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00001.html">fap_tx_rx_struct_t</a> *&nbsp;</td>
          <td class="paramname"> <em>ackdata</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for writing data to be piggybacked on the next acknowledge packet sent from the host to a device. 
<p>
This function will not initiate a transmission, but only prepare the data to be returned on the next package received from the selected device.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*ackdata</em>&nbsp;</td><td>[in] is a pointer to the input data structure containing the payload to be transmitted, the payload length and the transmit destination. </td></tr>
  </table>
</dl>

<p>
&lt; Returns true if tx fifo is full 
<p>
Definition at line <a class="el" href="a00094.html#l00365">365</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, <a class="el" href="a00128.html#l00168">FAP_MAX_ACK_PL_LENGTH</a>, <a class="el" href="a00099.html#l00137">hal_nrf_tx_fifo_full</a>, and <a class="el" href="a00098.html#l00211">hal_nrf_write_ack_pload()</a>.<div class="fragment"><pre class="fragment"><a name="l00366"></a>00366 {
<a name="l00367"></a>00367   <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00368"></a>00368 
<a name="l00369"></a>00369   <span class="keywordflow">if</span>(!<a class="code" href="a00030.html#084c8c90dae6a297d8253344b0fdcf5d">hal_nrf_tx_fifo_full</a>() &amp;&amp; !(ackdata -&gt; pl_length &gt; <a class="code" href="a00059.html#1d689f944ef61979cf7981c497f50486">FAP_MAX_ACK_PL_LENGTH</a>))
<a name="l00370"></a>00370   {
<a name="l00371"></a>00371     <a class="code" href="a00029.html#397a05d55963be6fb74111d9cf9bf1c4">hal_nrf_write_ack_pload</a>(ackdata -&gt; pipe, &amp;(ackdata -&gt; pl[0]), ackdata -&gt; pl_length);
<a name="l00372"></a>00372     <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00373"></a>00373     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00374"></a>00374   }
<a name="l00375"></a>00375   <span class="keywordflow">else</span>
<a name="l00376"></a>00376   {
<a name="l00377"></a>00377     <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00378"></a>00378     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00379"></a>00379   }
<a name="l00380"></a>00380 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="a00067_g48fb01570bc2097b9edfa3a8812fa94d_cgraph.png" border="0" usemap="#a00067_g48fb01570bc2097b9edfa3a8812fa94d_cgraph_map" alt=""></center>
<map name="a00067_g48fb01570bc2097b9edfa3a8812fa94d_cgraph_map">
<area href="a00029.html#397a05d55963be6fb74111d9cf9bf1c4" shape="rect" coords="202,5,367,32" alt="">
<area href="a00043.html#48058f0d26bed0107d1f0141b557ad8b" shape="rect" coords="418,5,476,32" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="g24a15b187addedf58f20ebb0a84503fc"></a><!-- doxytag: member="fap.h::fap_tx_fifo_full" ref="g24a15b187addedf58f20ebb0a84503fc" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fap_tx_fifo_full           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function returning <b>false</b> if TX FIFO full, else @ true. 
<p>

</div>
</div><p>
<a class="anchor" name="gdadf8034a8c5b3e16eada1983070b789"></a><!-- doxytag: member="fap.h::fap_set_output_power" ref="gdadf8034a8c5b3e16eada1983070b789" args="(U8 power)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fap_set_output_power           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a>&nbsp;</td>
          <td class="paramname"> <em>power</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for setting the radio output power. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>power</em>&nbsp;</td><td>selects the output power. Possible arguments are: <ul>
<li><code>HAL_NRF_0DBM</code> for 0 dBm output power </li>
<li><code>HAL_NRF_6DBM</code> for -6 dBm output power </li>
<li><code>HAL_NRF_12DBM</code> for -12 dBm output power </li>
<li><code>HAL_NRF_18DBM</code> for -18 dBm output power </li>
</ul>
</td></tr>
  </table>
</dl>

<p>
&lt; Sets the output signal power (0 to 3) 
<p>
Definition at line <a class="el" href="a00094.html#l00232">232</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, and <a class="el" href="a00099.html#l00115">hal_nrf_set_output_power</a>.<div class="fragment"><pre class="fragment"><a name="l00233"></a>00233 {
<a name="l00234"></a>00234   <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00235"></a>00235 
<a name="l00236"></a>00236   <a class="code" href="a00030.html#21236deff13ec979d07f3034a6fe4960">hal_nrf_set_output_power</a>(power);
<a name="l00237"></a>00237 
<a name="l00238"></a>00238   <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00239"></a>00239 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g9d5d854b0084d2bad76bd6730acbbc68"></a><!-- doxytag: member="fap.h::fap_ch_sync_enable" ref="g9d5d854b0084d2bad76bd6730acbbc68" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fap_ch_sync_enable           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for enabling a new transmission to be started synchronously to the receiver channel rotation. 
<p>
When synchronization is disabled, any new transmission will be started synchronously with an internal "frequency guess counter". This synchronization must be enabled whenever using the function <a class="el" href="a00067.html#g9d5d854b0084d2bad76bd6730acbbc68">fap_ch_sync_enable()</a>.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="a00067.html#gf6e3d10459030c28476c8e00ccfcb561">fap_get_ch_offset()</a>, <a class="el" href="a00067.html#gadbeb049d5ccbd2a7f3ec49cc0792e4c">fap_ch_sync_disable()</a> </dd></dl>

<p>
Definition at line <a class="el" href="a00094.html#l00462">462</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b5a9539514e56b772a2c2049e8acc0708">FAP_CH_SYNC_EN</a>, <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, <a class="el" href="a00095.html#l00063">FAP_SET_BIT</a>, and <a class="el" href="a00094.html#l00065">fap_status</a>.
<p>
Referenced by <a class="el" href="a00088.html#l00135">cdc_rf_task()</a>, and <a class="el" href="a00088.html#l00099">cdc_rf_task_init()</a>.<div class="fragment"><pre class="fragment"><a name="l00463"></a>00463 { 
<a name="l00464"></a>00464   <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00465"></a>00465 
<a name="l00466"></a>00466   <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b5a9539514e56b772a2c2049e8acc0708">FAP_CH_SYNC_EN</a>);
<a name="l00467"></a>00467 
<a name="l00468"></a>00468   <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00469"></a>00469 }
</pre></div>
<p>

<p>
Here is the caller graph for this function:<p><center><img src="a00067_g9d5d854b0084d2bad76bd6730acbbc68_icgraph.png" border="0" usemap="#a00067_g9d5d854b0084d2bad76bd6730acbbc68_icgraph_map" alt=""></center>
<map name="a00067_g9d5d854b0084d2bad76bd6730acbbc68_icgraph_map">
<area href="a00019.html#cca4b6216b3be1e1db321a93436d004d" shape="rect" coords="212,5,303,32" alt="">
<area href="a00019.html#d8b13fae75396c1142b12e8400bf8282" shape="rect" coords="200,56,315,83" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="gf6e3d10459030c28476c8e00ccfcb561"></a><!-- doxytag: member="fap.h::fap_get_ch_offset" ref="gf6e3d10459030c28476c8e00ccfcb561" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a> fap_get_ch_offset           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for getting the offset by the "guessed" receive channel and the previous successful transmit channel. 
<p>
The basic concept for the FAP is that the receiver continuously monitors a subset of channels in a rotating fashion. After a successful transmission the transmitting always adjusts an internal "guess counter" to equal this receive channel rotation. A new transmission is always started using the previous successful channel. When awaiting to send new data until this function equals 0, the data will be transmitted using the same frequency as the receiver most likely monitors, thus minimizing the number of retransmits.<p>
Note, when using this functionality, the channel synchronization must be enabled by <a class="el" href="a00067.html#g9d5d854b0084d2bad76bd6730acbbc68">fap_ch_sync_enable()</a>.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="a00067.html#gf6e3d10459030c28476c8e00ccfcb561">fap_get_ch_offset()</a>, <a class="el" href="a00067.html#gadbeb049d5ccbd2a7f3ec49cc0792e4c">fap_ch_sync_disable()</a> </dd></dl>

<p>
Definition at line <a class="el" href="a00094.html#l00480">480</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00094.html#l00076">fap_ch_tab_idx_tx</a>, <a class="el" href="a00128.html#l00128">FAP_CH_TAB_SIZE</a>, <a class="el" href="a00095.html#l00061">FAP_GET_BIT</a>, <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b8625cc7129d0e8049f1061d323a52535">FAP_PDOWN_IDLE_EN</a>, <a class="el" href="a00095.html#l00073">FAP_RADIO_PWR_UP_DELAY</a>, <a class="el" href="a00094.html#l00043">fap_rx_channel_guess</a>, <a class="el" href="a00094.html#l00065">fap_status</a>, and <a class="el" href="a00099.html#l00050">int8_t</a>.<div class="fragment"><pre class="fragment"><a name="l00481"></a>00481 {
<a name="l00482"></a>00482   <a class="code" href="a00030.html#9702e5ca80edeea90fa9b8fae49f05ce">int8_t</a> sync_var;
<a name="l00483"></a>00483   
<a name="l00484"></a>00484   <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00485"></a>00485   
<a name="l00486"></a>00486   sync_var = (<a class="code" href="a00025.html#d15e0b7d57aef8a352b93df6511342cb">fap_ch_tab_idx_tx</a> - <a class="code" href="a00025.html#ef1fae944bed2970c1f1d41cb7843f04">fap_rx_channel_guess</a>); 
<a name="l00487"></a>00487   
<a name="l00488"></a>00488   <span class="keywordflow">if</span>(<a class="code" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b8625cc7129d0e8049f1061d323a52535">FAP_PDOWN_IDLE_EN</a>))
<a name="l00489"></a>00489   {
<a name="l00490"></a>00490     sync_var -= <a class="code" href="a00067.html#g84b9c34cb03fefbee1372030b0ff6351">FAP_RADIO_PWR_UP_DELAY</a>; 
<a name="l00491"></a>00491   }
<a name="l00492"></a>00492    
<a name="l00493"></a>00493   <span class="keywordflow">if</span>(sync_var &lt; 0)
<a name="l00494"></a>00494   {
<a name="l00495"></a>00495     sync_var += <a class="code" href="a00059.html#aa26657c26f5abafd448320a4e45983d">FAP_CH_TAB_SIZE</a>;
<a name="l00496"></a>00496   }
<a name="l00497"></a>00497   
<a name="l00498"></a>00498   <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();  
<a name="l00499"></a>00499   
<a name="l00500"></a>00500   <span class="keywordflow">return</span> sync_var;   
<a name="l00501"></a>00501 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gadbeb049d5ccbd2a7f3ec49cc0792e4c"></a><!-- doxytag: member="fap.h::fap_ch_sync_disable" ref="gadbeb049d5ccbd2a7f3ec49cc0792e4c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fap_ch_sync_disable           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for disabling synchronization of transmission frequency to receive frequency. 
<p>
When synchronization is disabled, any new transmission will start immediately after calling <a class="el" href="a00067.html#ge6147d552537f3b74c7251af34041a35">fap_tx_data()</a>.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="a00067.html#gf6e3d10459030c28476c8e00ccfcb561">fap_get_ch_offset()</a>, <a class="el" href="a00067.html#g9d5d854b0084d2bad76bd6730acbbc68">fap_ch_sync_enable()</a> </dd></dl>

<p>
Definition at line <a class="el" href="a00094.html#l00471">471</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b5a9539514e56b772a2c2049e8acc0708">FAP_CH_SYNC_EN</a>, <a class="el" href="a00095.html#l00062">FAP_CLEAR_BIT</a>, <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, and <a class="el" href="a00094.html#l00065">fap_status</a>.<div class="fragment"><pre class="fragment"><a name="l00472"></a>00472 {
<a name="l00473"></a>00473   <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00474"></a>00474 
<a name="l00475"></a>00475   <a class="code" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b5a9539514e56b772a2c2049e8acc0708">FAP_CH_SYNC_EN</a>);
<a name="l00476"></a>00476 
<a name="l00477"></a>00477   <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00478"></a>00478 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g83d37651028ee29a9f78d61839dffac8"></a><!-- doxytag: member="fap.h::fap_tx_success" ref="g83d37651028ee29a9f78d61839dffac8" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fap_tx_success           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for getting the result of the previous transmit operation. 
<p>
The return value from this function is only credible when the FAP is in IDLE mode<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Result of the previous transmit operation.</dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>true</em>&nbsp;</td><td>if previous data were successfully transmitted, or if transmission in progress. (FAP mode TRANSMITTING). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>false</em>&nbsp;</td><td>if previous were not successfully transmitted </td></tr>
  </table>
</dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="a00067.html#ge6147d552537f3b74c7251af34041a35">fap_tx_data()</a>, <a class="el" href="a00067.html#gd39f595cbc496278f6064561649200c0">fap_get_mode()</a>, <a class="el" href="a00067.html#g265d0918166f0231f7f87e50005057bb">fap_goto_idle_mode(void)</a> </dd></dl>

<p>
Definition at line <a class="el" href="a00094.html#l00412">412</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00095.html#l00061">FAP_GET_BIT</a>, <a class="el" href="a00094.html#l00065">fap_status</a>, and <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b3b65e04ae72d05978f8f3fb5d1fe5b58">FAP_TX_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l00413"></a>00413 {
<a name="l00414"></a>00414   <span class="keywordflow">return</span> <a class="code" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b3b65e04ae72d05978f8f3fb5d1fe5b58">FAP_TX_SUCCESS</a>);
<a name="l00415"></a>00415 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gab2d09034e6cbd13aa75ff1e78e2ad3d"></a><!-- doxytag: member="fap.h::fap_get_tries" ref="gab2d09034e6cbd13aa75ff1e78e2ad3d" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00021.html#df928e51a60dba0df29d615401cc55a8">U16</a> fap_get_tries           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for providing the number of transmission attempts needed during the previous transmit operation. 
<p>
This function may be used as an indication on the current radio transmit conditions. In a noisy environment one will experience an increase in the number of transmission attempts needed for a successful packet delivery to the receiver. Note that even in an environment without any interfering radio sources one will experience that the FAP sometimes uses several transmission attempts. This due to the frequency altering scheme used at the receiver.<p>
The returned value from this function is only reliable when the FAP is in IDLE mode, and will only yield the previous transmitted package.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="a00067.html#g8c33715acccc57869fab5616c5209929">fap_get_ch_switches()</a>, <a class="el" href="a00067.html#gf6e3d10459030c28476c8e00ccfcb561">fap_get_ch_offset()</a>, <a class="el" href="a00067.html#gadbeb049d5ccbd2a7f3ec49cc0792e4c">fap_ch_sync_disable()</a>, <a class="el" href="a00067.html#gadbeb049d5ccbd2a7f3ec49cc0792e4c">fap_ch_sync_disable()</a> </dd></dl>

<p>
Definition at line <a class="el" href="a00094.html#l00452">452</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00094.html#l00071">fap_try_counter</a>.<div class="fragment"><pre class="fragment"><a name="l00453"></a>00453 {
<a name="l00454"></a>00454   <span class="keywordflow">return</span> <a class="code" href="a00025.html#65a157ccfce63f4a73578b968ad1cdd7">fap_try_counter</a>;
<a name="l00455"></a>00455 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="g8c33715acccc57869fab5616c5209929"></a><!-- doxytag: member="fap.h::fap_get_ch_switches" ref="g8c33715acccc57869fab5616c5209929" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00021.html#df928e51a60dba0df29d615401cc55a8">U16</a> fap_get_ch_switches           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for providing the number of frequency channel changes needed during the previous transmit operation. 
<p>
In an environment without any interfering radio sources one will not normally experience that the FAP needs to switch transmission frequency. A large number of channel switches will be an indication on extensive radio interference.<p>
The returbe value from this function is only reliable when the FAP is in IDLE mode.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="a00067.html#gab2d09034e6cbd13aa75ff1e78e2ad3d">fap_get_tries()</a> </dd></dl>

<p>
Definition at line <a class="el" href="a00094.html#l00457">457</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00094.html#l00081">fap_ch_switch_counter</a>.<div class="fragment"><pre class="fragment"><a name="l00458"></a>00458 {
<a name="l00459"></a>00459   <span class="keywordflow">return</span>  <a class="code" href="a00025.html#b23106c099ca8cf5dbf1f7dc6b8ce477">fap_ch_switch_counter</a>;
<a name="l00460"></a>00460 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="gec543eeacba621d36cc71eb399a084aa"></a><!-- doxytag: member="fap.h::fap_rx_data" ref="gec543eeacba621d36cc71eb399a084aa" args="(U8 rx_setup, U16 receive_timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fap_rx_data           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00021.html#3cb25ca6f51f003950f9625ff05536fc">U8</a>&nbsp;</td>
          <td class="paramname"> <em>rx_setup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00021.html#df928e51a60dba0df29d615401cc55a8">U16</a>&nbsp;</td>
          <td class="paramname"> <em>receive_timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for setting the FAP in receive mode and start monitoring the air for data. 
<p>
Received data will be stored in a FIFO which can be read out by the function <a class="el" href="a00067.html#ga01c21a346962faaf73e29722f8dd8bf">fap_read_rx_fifo()</a>. It may be specified a timeout period after which the FAP shall automatically stop receiving and return to IDLE mode.<p>
The FAP offers two different receive modes; one low power mode and one low latency mode. In low power mode the FAP is monitoring the air for data in only short slots of time and the receiver is switched off most of the time. This leads to a low power consumption at the receive side but a higher latency experienced at the transmit side as the transmitter has to "struggle" more to hit the the time slots the receiver is listening. In low latency mode the receiver is continuously monitoring the air for data, which gives a higher power consumption at the receive side but a lower experienced latency at the transmit side. The FAP do not have to be in IDLE mode before using this function. If the FAP is in receive mode when this function is used the new receive settings will apply immediately.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rx_setup</em>&nbsp;</td><td>selects receive power mode and pipe(s)/address(es) to monitor for incoming data. Bit 0-5 enables/disables receive pipes/addresses 0-5; 1 enables reception and 0 disables reception. Bit 6 selects the receive power mode; 1 sets receiver in low power mode and 0 sets the receiver in low latency mode.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>receive_timeout</em>&nbsp;</td><td>specifies the receive timeout period. The timeout period will be equivalent to receive_timeout*FAP_RX_PERIOD [us]. By setting this parameter to 0 the receiver will remain in receive mode until it is forced to IDLE mode by <a class="el" href="a00067.html#g265d0918166f0231f7f87e50005057bb">fap_goto_idle_mode()</a>. If a finite timeout is specified, it is recommended that the timeout value is set equal or grater than FAP_RX_FULL_CH_REV when operating in low latency mode or FAP_RX_SINGLE_CH_REV when operating in low power mode.</td></tr>
  </table>
</dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="a00067.html#gaed36c5567ef853d863244f3c8ef85ad">fap_set_address()</a>, <a class="el" href="a00067.html#gd39f595cbc496278f6064561649200c0">fap_get_mode()</a>, fap_get_rx_fifo_status(), <a class="el" href="a00067.html#ga01c21a346962faaf73e29722f8dd8bf">fap_read_rx_fifo()</a>, fap_select_rx_power_mode, <a class="el" href="a00067.html#g265d0918166f0231f7f87e50005057bb">fap_goto_idle_mode()</a> </dd></dl>

<p>
&lt; select pipe 0<p>
&lt; select all pipes<p>
&lt; Close selected pipe (pipe: 0~5)<p>
&lt; Open selected pipe (pipe: 0~5, AutoAck: 0/1)<p>
&lt; select pipe 5<p>
&lt; tranceiver power up<p>
&lt; Wake(1) or Shutdown(0) the tranceiver<p>
&lt; receiver mode<p>
&lt; puts the tranceiver into transmitter(0) or receiver(1)<p>
&lt; Enables the tranceiver 
<p>
Definition at line <a class="el" href="a00094.html#l00178">178</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00099.html#l00100">CE_HIGH</a>, <a class="el" href="a00105.html#l00107">EN_AA</a>, <a class="el" href="a00095.html#l00062">FAP_CLEAR_BIT</a>, <a class="el" href="a00094.html#l00045">fap_curr_tx_setup</a>, <a class="el" href="a00094.html#l00050">fap_general_byte</a>, <a class="el" href="a00095.html#l00061">FAP_GET_BIT</a>, <a class="el" href="a00094.html#l00694">fap_goto_idle_mode()</a>, <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, <a class="el" href="a00094.html#l00068">fap_latency_counter</a>, <a class="el" href="a00095.html#l00190">FAP_LP_RX_BIT</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b6f11fadf5d6a6de810c7bb73ebd5e4c7">FAP_LP_RX_EN</a>, <a class="el" href="a00094.html#l00073">fap_mode</a>, <a class="el" href="a00094.html#l00044">fap_p0_adr</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>, <a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697867e95ead0704559b85e6193170e13392">FAP_RECEIVING</a>, <a class="el" href="a00095.html#l00063">FAP_SET_BIT</a>, <a class="el" href="a00094.html#l00065">fap_status</a>, <a class="el" href="a00094.html#l00072">fap_timer_period</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b671d3bd25264460673bc79b7405ce414">FAP_TX_RX_INFINITE_TIMEOUT_EN</a>, <a class="el" href="a00099.html#l00074">HAL_NRF_ALL</a>, <a class="el" href="a00099.html#l00123">hal_nrf_close_pipe</a>, <a class="el" href="a00099.html#l00122">hal_nrf_open_pipe</a>, <a class="el" href="a00099.html#l00067">HAL_NRF_PIPE0</a>, <a class="el" href="a00099.html#l00076">HAL_NRF_PRX</a>, <a class="el" href="a00099.html#l00066">HAL_NRF_PWR_UP</a>, <a class="el" href="a00098.html#l00112">hal_nrf_set_address()</a>, <a class="el" href="a00099.html#l00117">hal_nrf_set_operation_mode</a>, and <a class="el" href="a00099.html#l00116">hal_nrf_set_power_mode</a>.
<p>
Referenced by <a class="el" href="a00088.html#l00135">cdc_rf_task()</a>, and <a class="el" href="a00088.html#l00099">cdc_rf_task_init()</a>.<div class="fragment"><pre class="fragment"><a name="l00179"></a>00179 {
<a name="l00180"></a>00180   <a class="code" href="a00067.html#g265d0918166f0231f7f87e50005057bb">fap_goto_idle_mode</a>();
<a name="l00181"></a>00181 
<a name="l00182"></a>00182   <a class="code" href="a00025.html#5f5d4f3ec65eec85c2354c20ca3266b4">fap_curr_tx_setup</a> = 0xff; <span class="comment">// Signals that TX setup must be restored at next transmission </span>
<a name="l00183"></a>00183 
<a name="l00184"></a>00184   <span class="keywordflow">if</span>(rx_setup &amp; (0x3f))     <span class="comment">// Check if any pipe is enabeled for receiving  </span>
<a name="l00185"></a>00185   {
<a name="l00186"></a>00186     <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00187"></a>00187   
<a name="l00188"></a>00188     <a class="code" href="a00029.html#4529776acbd4170ce057e4fa678a1889">hal_nrf_set_address</a>(<a class="code" href="a00030.html#41987623eab14c90171466953e5569e0">HAL_NRF_PIPE0</a>, <a class="code" href="a00025.html#ca0a0f73d5998b5fbf60bd9e01ebbad9">fap_p0_adr</a>);  
<a name="l00189"></a>00189   
<a name="l00190"></a>00190     <a class="code" href="a00030.html#9fc38033904e9880036ee16bdde2c0db">hal_nrf_close_pipe</a>(<a class="code" href="a00030.html#58ed45a84a9c36b6b94cd99f3a23cbe8">HAL_NRF_ALL</a>); 
<a name="l00191"></a>00191     <span class="keywordflow">for</span>(<a class="code" href="a00025.html#b3ee3c6e2ce582ebb12137b45beae9f9">fap_general_byte</a> = 0; <a class="code" href="a00025.html#b3ee3c6e2ce582ebb12137b45beae9f9">fap_general_byte</a> &lt; 6; <a class="code" href="a00025.html#b3ee3c6e2ce582ebb12137b45beae9f9">fap_general_byte</a>++)
<a name="l00192"></a>00192     {
<a name="l00193"></a>00193       <span class="keywordflow">if</span>(rx_setup &amp; (1 &lt;&lt; <a class="code" href="a00025.html#b3ee3c6e2ce582ebb12137b45beae9f9">fap_general_byte</a>))
<a name="l00194"></a>00194       {
<a name="l00195"></a>00195         <a class="code" href="a00030.html#1861341afb8f3d19e375053c850fd540">hal_nrf_open_pipe</a>(<a class="code" href="a00025.html#b3ee3c6e2ce582ebb12137b45beae9f9">fap_general_byte</a>, <a class="code" href="a00036.html#a84a282351a2c9b83dd653df6ac59216">EN_AA</a>);  
<a name="l00196"></a>00196       }
<a name="l00197"></a>00197     }
<a name="l00198"></a>00198   
<a name="l00199"></a>00199     <span class="keywordflow">if</span>(<a class="code" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(rx_setup, <a class="code" href="a00067.html#gd579a706380c94617a85dd2c827035df">FAP_LP_RX_BIT</a>))
<a name="l00200"></a>00200     {
<a name="l00201"></a>00201       <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b6f11fadf5d6a6de810c7bb73ebd5e4c7">FAP_LP_RX_EN</a>);  
<a name="l00202"></a>00202     }
<a name="l00203"></a>00203     <span class="keywordflow">else</span>
<a name="l00204"></a>00204     {
<a name="l00205"></a>00205       <a class="code" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b6f11fadf5d6a6de810c7bb73ebd5e4c7">FAP_LP_RX_EN</a>);    
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208     <a class="code" href="a00030.html#3334b75f295de730325aeb0ab47b471a">hal_nrf_set_power_mode</a>(<a class="code" href="a00030.html#c4d45d9ed6219f65866b090cd84543e4">HAL_NRF_PWR_UP</a>);
<a name="l00209"></a>00209     <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>);
<a name="l00210"></a>00210 
<a name="l00211"></a>00211     <a class="code" href="a00030.html#264459a33aebd0f37e88642486e506dd">hal_nrf_set_operation_mode</a>(<a class="code" href="a00030.html#a4a2b3f412c7dd9e6eefaa73dee3b09c">HAL_NRF_PRX</a>);
<a name="l00212"></a>00212       
<a name="l00213"></a>00213     <span class="keywordflow">if</span>(rx_timeout==0)
<a name="l00214"></a>00214     {
<a name="l00215"></a>00215       <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b671d3bd25264460673bc79b7405ce414">FAP_TX_RX_INFINITE_TIMEOUT_EN</a>);
<a name="l00216"></a>00216     }
<a name="l00217"></a>00217     <span class="keywordflow">else</span>
<a name="l00218"></a>00218     {
<a name="l00219"></a>00219       <a class="code" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b671d3bd25264460673bc79b7405ce414">FAP_TX_RX_INFINITE_TIMEOUT_EN</a>);
<a name="l00220"></a>00220       <a class="code" href="a00025.html#fac0a12b2c8ed9ae94fa2cbc6ab17ed1">fap_latency_counter</a>=rx_timeout;   
<a name="l00221"></a>00221     }
<a name="l00222"></a>00222   
<a name="l00223"></a>00223     <a class="code" href="a00025.html#c05ef73eb0018ffdbc75f4dda3b68258">fap_timer_period</a>=0;
<a name="l00224"></a>00224     <a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a>=<a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697867e95ead0704559b85e6193170e13392">FAP_RECEIVING</a>;
<a name="l00225"></a>00225   
<a name="l00226"></a>00226     <a class="code" href="a00030.html#0b7419f0782729de0b8ffabffab8e995">CE_HIGH</a>();
<a name="l00227"></a>00227     
<a name="l00228"></a>00228     <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>(); 
<a name="l00229"></a>00229   }
<a name="l00230"></a>00230 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="a00067_gec543eeacba621d36cc71eb399a084aa_cgraph.png" border="0" usemap="#a00067_gec543eeacba621d36cc71eb399a084aa_cgraph_map" alt=""></center>
<map name="a00067_gec543eeacba621d36cc71eb399a084aa_cgraph_map">
<area href="a00067.html#g265d0918166f0231f7f87e50005057bb" shape="rect" coords="147,5,291,32" alt="">
<area href="a00029.html#4529776acbd4170ce057e4fa678a1889" shape="rect" coords="148,56,289,83" alt="">
<area href="a00035.html#9856ea5a03c048d29e4670d94a87f51f" shape="rect" coords="340,56,449,83" alt="">
<area href="a00043.html#48058f0d26bed0107d1f0141b557ad8b" shape="rect" coords="500,56,559,83" alt="">
</map>

<p>
Here is the caller graph for this function:<p><center><img src="a00067_gec543eeacba621d36cc71eb399a084aa_icgraph.png" border="0" usemap="#a00067_gec543eeacba621d36cc71eb399a084aa_icgraph_map" alt=""></center>
<map name="a00067_gec543eeacba621d36cc71eb399a084aa_icgraph_map">
<area href="a00019.html#cca4b6216b3be1e1db321a93436d004d" shape="rect" coords="159,5,250,32" alt="">
<area href="a00019.html#d8b13fae75396c1142b12e8400bf8282" shape="rect" coords="147,56,262,83" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="gdaf75426e4c6b294e2d0733d8ef9c2b2"></a><!-- doxytag: member="fap.h::fap_flush_rx_fifo" ref="gdaf75426e4c6b294e2d0733d8ef9c2b2" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fap_flush_rx_fifo           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for flushing the hardware receive FIFO. 
<p>
It is recommended that the FAP is in IDLE mode whenever this function is called. 
<p>
&lt; flushs the rx buffer 
<p>
Definition at line <a class="el" href="a00094.html#l00685">685</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, and <a class="el" href="a00099.html#l00110">hal_nrf_flush_rx</a>.<div class="fragment"><pre class="fragment"><a name="l00686"></a>00686 {
<a name="l00687"></a>00687     <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>();
<a name="l00688"></a>00688 
<a name="l00689"></a>00689     <a class="code" href="a00030.html#d578f0da2551eea2b0a6d725e329101d">hal_nrf_flush_rx</a>();
<a name="l00690"></a>00690 
<a name="l00691"></a>00691     <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();
<a name="l00692"></a>00692 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ga01c21a346962faaf73e29722f8dd8bf"></a><!-- doxytag: member="fap.h::fap_read_rx_fifo" ref="ga01c21a346962faaf73e29722f8dd8bf" args="(fap_tx_rx_struct_t *return_struct)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fap_read_rx_fifo           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00001.html">fap_tx_rx_struct_t</a> *&nbsp;</td>
          <td class="paramname"> <em>return_struct</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function for reading received data from receive FIFO. 
<p>
When the FAP is in receive mode all incoming data will be stored in a FIFO which can be read using this function.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>return_struct</em>&nbsp;</td><td>specifies the destination to where FIFO read data shall be copied. This is a structure type <a class="el" href="a00001.html">fap_tx_rx_struct_t</a> which contains the field pl for the actual payload data, pl_length for the received payload length and pipe which tells the pipe in which the data were received.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Information on whether FIFO contained data or not. </dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>true</em>&nbsp;</td><td>if unread FIFO data were copied to destination. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>false</em>&nbsp;</td><td>if FIFO was empty and no data were copied. </td></tr>
  </table>
</dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="a00067.html#gec543eeacba621d36cc71eb399a084aa">fap_rx_data()</a>, fap_get_rx_fifo_status(), </dd></dl>

<p>
&lt; Returns true if rx fifo is empty 
<p>
Definition at line <a class="el" href="a00094.html#l00387">387</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00094.html#l00035">FAP_INTERRUPTS_DISABLE</a>, <a class="el" href="a00094.html#l00037">FAP_INTERRUPTS_ENABLE</a>, <a class="el" href="a00098.html#l00061">hal_nrf_read_rx_pload()</a>, <a class="el" href="a00099.html#l00134">hal_nrf_rx_fifo_empty</a>, <a class="el" href="a00090.html#l00191">LSB</a>, <a class="el" href="a00090.html#l00190">MSB</a>, and <a class="el" href="a00099.html#l00049">uint16_t</a>.
<p>
Referenced by <a class="el" href="a00088.html#l00135">cdc_rf_task()</a>.<div class="fragment"><pre class="fragment"><a name="l00388"></a>00388 {  
<a name="l00389"></a>00389   <span class="keyword">volatile</span> <a class="code" href="a00030.html#395b3b2bf5cb4674ab41b6bda68c15bb">uint16_t</a> tempvalue;
<a name="l00390"></a>00390 
<a name="l00391"></a>00391   <a class="code" href="a00025.html#6cba79f27b44febd4a6087d22e4c689b">FAP_INTERRUPTS_DISABLE</a>(); 
<a name="l00392"></a>00392   
<a name="l00393"></a>00393   <span class="keywordflow">if</span>(!<a class="code" href="a00030.html#45a98aa687b9e1289c0814b26c483895">hal_nrf_rx_fifo_empty</a>())
<a name="l00394"></a>00394   {
<a name="l00395"></a>00395     tempvalue = <a class="code" href="a00029.html#299546e4031cda42178a2f41c49bbb00">hal_nrf_read_rx_pload</a>(&amp;(return_struct -&gt; pl[0])); 
<a name="l00396"></a>00396     <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();          
<a name="l00397"></a>00397     
<a name="l00398"></a>00398     return_struct -&gt; pipe=<a class="code" href="a00021.html#bee1b74eceef5a0cf26efbf3ff87ccbf">MSB</a>(tempvalue);   <span class="comment">// MSByte, pipe    </span>
<a name="l00399"></a>00399     return_struct -&gt; pl_length=<a class="code" href="a00021.html#bd2fa7b756342ae251e3a7a66670c2fe">LSB</a>(tempvalue); <span class="comment">// LSByte=length  </span>
<a name="l00400"></a>00400   <span class="comment">/*  return_struct -&gt; pipe=(uint8_t)(tempvalue&gt;&gt;8);   // MSByte, pipe    </span>
<a name="l00401"></a>00401 <span class="comment">    return_struct -&gt; pl_length=(uint8_t)(tempvalue); // LSByte=length  */</span>
<a name="l00402"></a>00402    
<a name="l00403"></a>00403     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00404"></a>00404   }
<a name="l00405"></a>00405   <span class="keywordflow">else</span>
<a name="l00406"></a>00406   {
<a name="l00407"></a>00407     <a class="code" href="a00025.html#ddd8f5830629cdf8a71dddce12564a56">FAP_INTERRUPTS_ENABLE</a>();  
<a name="l00408"></a>00408     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00409"></a>00409   }
<a name="l00410"></a>00410 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="a00067_ga01c21a346962faaf73e29722f8dd8bf_cgraph.png" border="0" usemap="#a00067_ga01c21a346962faaf73e29722f8dd8bf_cgraph_map" alt=""></center>
<map name="a00067_ga01c21a346962faaf73e29722f8dd8bf_cgraph_map">
<area href="a00029.html#299546e4031cda42178a2f41c49bbb00" shape="rect" coords="174,31,328,57" alt="">
<area href="a00035.html#ec197f260d62f70285ef5c14a874aca1" shape="rect" coords="388,5,476,32" alt="">
<area href="a00035.html#500e0a5e1a6dcabed1eb20f1c51cd6d3" shape="rect" coords="378,56,487,83" alt="">
<area href="a00043.html#48058f0d26bed0107d1f0141b557ad8b" shape="rect" coords="538,31,596,57" alt="">
</map>

<p>
Here is the caller graph for this function:<p><center><img src="a00067_ga01c21a346962faaf73e29722f8dd8bf_icgraph.png" border="0" usemap="#a00067_ga01c21a346962faaf73e29722f8dd8bf_icgraph_map" alt=""></center>
<map name="a00067_ga01c21a346962faaf73e29722f8dd8bf_icgraph_map">
<area href="a00019.html#cca4b6216b3be1e1db321a93436d004d" shape="rect" coords="173,5,264,32" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="g973ee6d1b243317e14abbbd39e3c3829"></a><!-- doxytag: member="fap.h::fap_nrf_isr_function" ref="g973ee6d1b243317e14abbbd39e3c3829" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fap_nrf_isr_function           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function to be called by the nRF radio interrupt service routine. 
<p>

<p>
&lt; Returns the irq flags and clear them<p>
&lt; Max retransmits<p>
&lt; Disables the tranceiver<p>
&lt; Sets the frequency channel (0 to 123)<p>
&lt; Enables the tranceiver<p>
&lt; TX data sent<p>
&lt; Returns the number of transmit attemps<p>
&lt; Returns true if tx fifo is empty<p>
&lt; RX data ready 
<p>
Definition at line <a class="el" href="a00094.html#l00503">503</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00099.html#l00100">CE_HIGH</a>, <a class="el" href="a00099.html#l00099">CE_LOW</a>, <a class="el" href="a00128.html#l00156">FAP_AUTO_RETRIES_EXTEND</a>, <a class="el" href="a00094.html#l00081">fap_ch_switch_counter</a>, <a class="el" href="a00094.html#l00042">fap_ch_tab</a>, <a class="el" href="a00094.html#l00076">fap_ch_tab_idx_tx</a>, <a class="el" href="a00128.html#l00128">FAP_CH_TAB_SIZE</a>, <a class="el" href="a00095.html#l00062">FAP_CLEAR_BIT</a>, <a class="el" href="a00094.html#l00050">fap_general_byte</a>, <a class="el" href="a00095.html#l00061">FAP_GET_BIT</a>, <a class="el" href="a00094.html#l00078">fap_hold_rx_channel</a>, <a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2">FAP_IDLE</a>, <a class="el" href="a00094.html#l00068">fap_latency_counter</a>, <a class="el" href="a00094.html#l00068">fap_latency_setup</a>, <a class="el" href="a00094.html#l00710">fap_lfsr_get()</a>, <a class="el" href="a00094.html#l00073">fap_mode</a>, <a class="el" href="a00098.html#l00243">fap_modify_timer_period()</a>, <a class="el" href="a00128.html#l00148">FAP_NRF_AUTO_RETRIES</a>, <a class="el" href="a00094.html#l00069">fap_retry_extend_counter</a>, <a class="el" href="a00128.html#l00175">FAP_RX_CH_HOLD_PERIODS</a>, <a class="el" href="a00094.html#l00043">fap_rx_channel_guess</a>, <a class="el" href="a00095.html#l00063">FAP_SET_BIT</a>, <a class="el" href="a00094.html#l00730">fap_set_system_idle()</a>, <a class="el" href="a00094.html#l00065">fap_status</a>, <a class="el" href="a00096.html#l00032">FAP_TIMER_IRQ_DISABLE</a>, <a class="el" href="a00096.html#l00031">FAP_TIMER_IRQ_ENABLE</a>, <a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c869789c4a1edf3ad50e19eaf13e1d7892cc2f">FAP_TRANSMITTING</a>, <a class="el" href="a00094.html#l00071">fap_try_counter</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b671d3bd25264460673bc79b7405ce414">FAP_TX_RX_INFINITE_TIMEOUT_EN</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b3b65e04ae72d05978f8f3fb5d1fe5b58">FAP_TX_SUCCESS</a>, <a class="el" href="a00099.html#l00140">hal_nrf_get_clear_irq_flags</a>, <a class="el" href="a00099.html#l00126">hal_nrf_get_transmit_attempts</a>, <a class="el" href="a00099.html#l00114">hal_nrf_set_rf_channel</a>, <a class="el" href="a00099.html#l00135">hal_nrf_tx_fifo_empty</a>, <a class="el" href="a00099.html#l00089">NRF_MAX_RT</a>, <a class="el" href="a00099.html#l00086">NRF_RX_DR</a>, <a class="el" href="a00099.html#l00087">NRF_TX_DS</a>, and <a class="el" href="a00099.html#l00048">uint8_t</a>.
<p>
Referenced by <a class="el" href="a00088.html#l00221">fap_nrf_interrupt()</a>.<div class="fragment"><pre class="fragment"><a name="l00504"></a>00504 {
<a name="l00505"></a>00505   <span class="keyword">static</span> <a class="code" href="a00030.html#b077fa1127453be2bd9d4c3c8a768fa7">uint8_t</a> random_seed;
<a name="l00506"></a>00506 
<a name="l00507"></a>00507   <a class="code" href="a00068.html#gef142c18996041b65d38b557a3681aa6">FAP_TIMER_IRQ_DISABLE</a>();                      
<a name="l00508"></a>00508 
<a name="l00509"></a>00509   <a class="code" href="a00025.html#b3ee3c6e2ce582ebb12137b45beae9f9">fap_general_byte</a>=<a class="code" href="a00030.html#c91c771ac6ea1910a50ecb83ec63b4eb">hal_nrf_get_clear_irq_flags</a>(); <span class="comment">// Get/clear IRQ flags</span>
<a name="l00510"></a>00510   
<a name="l00511"></a>00511   <span class="keywordflow">if</span>(<a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a> != <a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697889880a774223c3a311d7e7bd6be783f2">FAP_IDLE</a>)
<a name="l00512"></a>00512   {
<a name="l00513"></a>00513     <span class="keywordflow">if</span>(<a class="code" href="a00025.html#b3ee3c6e2ce582ebb12137b45beae9f9">fap_general_byte</a> &amp; ((1&lt;&lt;<a class="code" href="a00030.html#a8de80d008bac8de2eea8041f5b7fbd1">NRF_MAX_RT</a>)))
<a name="l00514"></a>00514     {
<a name="l00515"></a>00515       <a class="code" href="a00025.html#65a157ccfce63f4a73578b968ad1cdd7">fap_try_counter</a> += (<a class="code" href="a00059.html#099a76c5ef26c4751ee6f0516aa4b37c">FAP_NRF_AUTO_RETRIES</a>+1);
<a name="l00516"></a>00516         
<a name="l00517"></a>00517       <a class="code" href="a00025.html#a66224a1e157cc5bbdce726375dc0cb1">fap_retry_extend_counter</a>= (<a class="code" href="a00025.html#a66224a1e157cc5bbdce726375dc0cb1">fap_retry_extend_counter</a>+1) % <a class="code" href="a00059.html#906ad487c0b2a31e65591ad26c51b6a9">FAP_AUTO_RETRIES_EXTEND</a>;
<a name="l00518"></a>00518     
<a name="l00519"></a>00519       <span class="keywordflow">if</span>(<a class="code" href="a00025.html#a66224a1e157cc5bbdce726375dc0cb1">fap_retry_extend_counter</a>==0)
<a name="l00520"></a>00520       {
<a name="l00521"></a>00521         <span class="keywordflow">if</span>(((<a class="code" href="a00025.html#b23106c099ca8cf5dbf1f7dc6b8ce477">fap_ch_switch_counter</a>+1)%<a class="code" href="a00059.html#aa26657c26f5abafd448320a4e45983d">FAP_CH_TAB_SIZE</a>) == 0)
<a name="l00522"></a>00522         { 
<a name="l00523"></a>00523           <a class="code" href="a00025.html#d15e0b7d57aef8a352b93df6511342cb">fap_ch_tab_idx_tx</a> = <a class="code" href="a00025.html#456dfcb1a33aef4256d7bf460e2ab7aa">fap_lfsr_get</a>(random_seed, <a class="code" href="a00059.html#aa26657c26f5abafd448320a4e45983d">FAP_CH_TAB_SIZE</a>);  
<a name="l00524"></a>00524         }
<a name="l00525"></a>00525         <span class="keywordflow">else</span>
<a name="l00526"></a>00526         {
<a name="l00527"></a>00527           <a class="code" href="a00025.html#d15e0b7d57aef8a352b93df6511342cb">fap_ch_tab_idx_tx</a> = <a class="code" href="a00025.html#456dfcb1a33aef4256d7bf460e2ab7aa">fap_lfsr_get</a>(0, <a class="code" href="a00059.html#aa26657c26f5abafd448320a4e45983d">FAP_CH_TAB_SIZE</a>);    
<a name="l00528"></a>00528         }   
<a name="l00529"></a>00529         
<a name="l00530"></a>00530         <a class="code" href="a00030.html#2507e21a12efd35e9e9221903456fbc9">CE_LOW</a>();                      
<a name="l00531"></a>00531         <a class="code" href="a00030.html#887c567677a6475cef9b55089918ee7b">hal_nrf_set_rf_channel</a>(<a class="code" href="a00025.html#47208fa4ba15fee8caab858a70381a77">fap_ch_tab</a>[<a class="code" href="a00025.html#d15e0b7d57aef8a352b93df6511342cb">fap_ch_tab_idx_tx</a>]);                  
<a name="l00532"></a>00532         <a class="code" href="a00025.html#b23106c099ca8cf5dbf1f7dc6b8ce477">fap_ch_switch_counter</a>++;
<a name="l00533"></a>00533       }
<a name="l00534"></a>00534 
<a name="l00535"></a>00535       <a class="code" href="a00025.html#fac0a12b2c8ed9ae94fa2cbc6ab17ed1">fap_latency_counter</a> -= (<a class="code" href="a00059.html#099a76c5ef26c4751ee6f0516aa4b37c">FAP_NRF_AUTO_RETRIES</a>+1); 
<a name="l00536"></a>00536       <span class="keywordflow">if</span>(<a class="code" href="a00025.html#fac0a12b2c8ed9ae94fa2cbc6ab17ed1">fap_latency_counter</a>&lt;1 &amp;&amp; !<a class="code" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b671d3bd25264460673bc79b7405ce414">FAP_TX_RX_INFINITE_TIMEOUT_EN</a>))    
<a name="l00537"></a>00537       {
<a name="l00538"></a>00538         <a class="code" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b3b65e04ae72d05978f8f3fb5d1fe5b58">FAP_TX_SUCCESS</a>); 
<a name="l00539"></a>00539         <a class="code" href="a00025.html#a02254cf544ab0f0211a71ebc4755d57">fap_set_system_idle</a>();
<a name="l00540"></a>00540       }
<a name="l00541"></a>00541       <span class="keywordflow">else</span>
<a name="l00542"></a>00542       {
<a name="l00543"></a>00543         <a class="code" href="a00030.html#0b7419f0782729de0b8ffabffab8e995">CE_HIGH</a>();                     
<a name="l00544"></a>00544       }
<a name="l00545"></a>00545     }
<a name="l00546"></a>00546     <span class="keywordflow">else</span>
<a name="l00547"></a>00547     {
<a name="l00548"></a>00548       <span class="keywordflow">if</span>(<a class="code" href="a00025.html#b3ee3c6e2ce582ebb12137b45beae9f9">fap_general_byte</a> &amp; ((1&lt;&lt;<a class="code" href="a00030.html#c9a034cc44596576c8ba9b90b4d34e40">NRF_TX_DS</a>)))
<a name="l00549"></a>00549       {
<a name="l00550"></a>00550          <span class="keywordflow">if</span>(<a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a>==<a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c869789c4a1edf3ad50e19eaf13e1d7892cc2f">FAP_TRANSMITTING</a>) 
<a name="l00551"></a>00551         { 
<a name="l00552"></a>00552        
<a name="l00553"></a>00553            <span class="comment">// Adjusts "guess counter" </span>
<a name="l00554"></a>00554           <a class="code" href="a00025.html#ef1fae944bed2970c1f1d41cb7843f04">fap_rx_channel_guess</a> = (<a class="code" href="a00025.html#d15e0b7d57aef8a352b93df6511342cb">fap_ch_tab_idx_tx</a> + 1) % <a class="code" href="a00059.html#aa26657c26f5abafd448320a4e45983d">FAP_CH_TAB_SIZE</a>;                  
<a name="l00555"></a>00555           <a class="code" href="a00067.html#gc448074facafef1f43e296c8fd60d6d0">fap_modify_timer_period</a>();
<a name="l00556"></a>00556         
<a name="l00557"></a>00557           <span class="comment">// Get number of tries. Add 1 for 1st attempt.                   </span>
<a name="l00558"></a>00558           <a class="code" href="a00025.html#65a157ccfce63f4a73578b968ad1cdd7">fap_try_counter</a> += (<a class="code" href="a00030.html#9a712862a3cdeabda3c742470586325d">hal_nrf_get_transmit_attempts</a>()+1);  
<a name="l00559"></a>00559         
<a name="l00560"></a>00560           <span class="comment">// Get "random" seed fom number of sent packages</span>
<a name="l00561"></a>00561           <span class="comment">// Used when altering channel search order</span>
<a name="l00562"></a>00562           random_seed = random_seed+<a class="code" href="a00025.html#65a157ccfce63f4a73578b968ad1cdd7">fap_try_counter</a>;  
<a name="l00563"></a>00563              
<a name="l00564"></a>00564           <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b3b65e04ae72d05978f8f3fb5d1fe5b58">FAP_TX_SUCCESS</a>);
<a name="l00565"></a>00565        
<a name="l00566"></a>00566           <span class="keywordflow">if</span>(<a class="code" href="a00030.html#15d76b0cccaab7aa8f3be8d400b48037">hal_nrf_tx_fifo_empty</a>())
<a name="l00567"></a>00567           {
<a name="l00568"></a>00568             <a class="code" href="a00025.html#a02254cf544ab0f0211a71ebc4755d57">fap_set_system_idle</a>();
<a name="l00569"></a>00569           }
<a name="l00570"></a>00570           <span class="keywordflow">else</span>
<a name="l00571"></a>00571           {
<a name="l00572"></a>00572             <a class="code" href="a00025.html#a66224a1e157cc5bbdce726375dc0cb1">fap_retry_extend_counter</a> = 0;
<a name="l00573"></a>00573             fap_try_counter = 0;
<a name="l00574"></a>00574             <a class="code" href="a00025.html#fac0a12b2c8ed9ae94fa2cbc6ab17ed1">fap_latency_counter</a> = <a class="code" href="a00025.html#12e9db9d3d304ee12de2747eda102bee">fap_latency_setup</a>;
<a name="l00575"></a>00575           }
<a name="l00576"></a>00576                                              
<a name="l00577"></a>00577           <span class="comment">// Get "random" seed fom number of sent packages</span>
<a name="l00578"></a>00578           <span class="comment">// Used when altering channel search order             </span>
<a name="l00579"></a>00579         } 
<a name="l00580"></a>00580       }
<a name="l00581"></a>00581 
<a name="l00582"></a>00582       <span class="keywordflow">if</span>(<a class="code" href="a00025.html#b3ee3c6e2ce582ebb12137b45beae9f9">fap_general_byte</a> &amp; ((1&lt;&lt;<a class="code" href="a00030.html#8875452ea824d9cdaec5bbf520bcc6fa">NRF_RX_DR</a>)))
<a name="l00583"></a>00583       {
<a name="l00584"></a>00584         <a class="code" href="a00025.html#82997674dcc4273bf292fd681ec199a7">fap_hold_rx_channel</a> = <a class="code" href="a00059.html#912eb031875a8eaa45e54d8c27c95a80">FAP_RX_CH_HOLD_PERIODS</a>;  <span class="comment">// Applies in RX mode only</span>
<a name="l00585"></a>00585       }
<a name="l00586"></a>00586     }     
<a name="l00587"></a>00587   }
<a name="l00588"></a>00588   
<a name="l00589"></a>00589   <a class="code" href="a00068.html#ge18e2a549ce7c4a99a4baf43feaf733d">FAP_TIMER_IRQ_ENABLE</a>();  
<a name="l00590"></a>00590 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="a00067_g973ee6d1b243317e14abbbd39e3c3829_cgraph.png" border="0" usemap="#a00067_g973ee6d1b243317e14abbbd39e3c3829_cgraph_map" alt=""></center>
<map name="a00067_g973ee6d1b243317e14abbbd39e3c3829_cgraph_map">
<area href="a00025.html#456dfcb1a33aef4256d7bf460e2ab7aa" shape="rect" coords="234,6,327,32" alt="">
<area href="a00067.html#gc448074facafef1f43e296c8fd60d6d0" shape="rect" coords="195,56,366,83" alt="">
<area href="a00025.html#a02254cf544ab0f0211a71ebc4755d57" shape="rect" coords="208,107,352,134" alt="">
</map>

<p>
Here is the caller graph for this function:<p><center><img src="a00067_g973ee6d1b243317e14abbbd39e3c3829_icgraph.png" border="0" usemap="#a00067_g973ee6d1b243317e14abbbd39e3c3829_icgraph_map" alt=""></center>
<map name="a00067_g973ee6d1b243317e14abbbd39e3c3829_icgraph_map">
<area href="a00019.html#c44934ce91e0b9d184169b40720b581d" shape="rect" coords="196,5,316,32" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="g7a93db234bd573547615a02e536af4f3"></a><!-- doxytag: member="fap.h::fap_timer_isr_function" ref="g7a93db234bd573547615a02e536af4f3" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fap_timer_isr_function           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function to be called by the FAP timer interrupt service routine. 
<p>
The FAP requires one dedicated auto reload timer. This function must be called by the FAP timer interrupt service routine. 
<p>
&lt; Enables the tranceiver<p>
&lt; Disables the tranceiver<p>
&lt; Sets the frequency channel (0 to 123)<p>
&lt; Enables the tranceiver<p>
&lt; Sets the frequency channel (0 to 123)<p>
&lt; tranceiver power up<p>
&lt; Wake(1) or Shutdown(0) the tranceiver<p>
&lt; Disables the tranceiver<p>
&lt; tranceiver power down<p>
&lt; Wake(1) or Shutdown(0) the tranceiver<p>
&lt; Enables the tranceiver<p>
&lt; Disables the tranceiver 
<p>
Definition at line <a class="el" href="a00094.html#l00592">592</a> of file <a class="el" href="a00094.html">fap.c</a>.
<p>
References <a class="el" href="a00099.html#l00100">CE_HIGH</a>, <a class="el" href="a00099.html#l00099">CE_LOW</a>, <a class="el" href="a00094.html#l00042">fap_ch_tab</a>, <a class="el" href="a00094.html#l00077">fap_ch_tab_idx_rx</a>, <a class="el" href="a00128.html#l00128">FAP_CH_TAB_SIZE</a>, <a class="el" href="a00095.html#l00062">FAP_CLEAR_BIT</a>, <a class="el" href="a00095.html#l00061">FAP_GET_BIT</a>, <a class="el" href="a00094.html#l00078">fap_hold_rx_channel</a>, <a class="el" href="a00094.html#l00068">fap_latency_counter</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b6f11fadf5d6a6de810c7bb73ebd5e4c7">FAP_LP_RX_EN</a>, <a class="el" href="a00095.html#l00041">FAP_LP_RX_LISTEN_PERIODS</a>, <a class="el" href="a00128.html#l00207">FAP_LP_RX_POLL_PERIOD</a>, <a class="el" href="a00094.html#l00073">fap_mode</a>, <a class="el" href="a00096.html#l00030">FAP_NRF_IRQ_DISABLE</a>, <a class="el" href="a00096.html#l00029">FAP_NRF_IRQ_ENABLE</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>, <a class="el" href="a00095.html#l00073">FAP_RADIO_PWR_UP_DELAY</a>, <a class="el" href="a00094.html#l00067">fap_radio_startup_counter</a>, <a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697867e95ead0704559b85e6193170e13392">FAP_RECEIVING</a>, <a class="el" href="a00094.html#l00043">fap_rx_channel_guess</a>, <a class="el" href="a00095.html#l00131">FAP_RX_FULL_CH_REV</a>, <a class="el" href="a00095.html#l00108">FAP_RX_SINGLE_CH_REV</a>, <a class="el" href="a00095.html#l00063">FAP_SET_BIT</a>, <a class="el" href="a00094.html#l00730">fap_set_system_idle()</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b75787cc22817c3d5028085ce0b8cb56f">FAP_START_NEW_TX</a>, <a class="el" href="a00094.html#l00065">fap_status</a>, <a class="el" href="a00094.html#l00072">fap_timer_period</a>, <a class="el" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c869789c4a1edf3ad50e19eaf13e1d7892cc2f">FAP_TRANSMITTING</a>, <a class="el" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b671d3bd25264460673bc79b7405ce414">FAP_TX_RX_INFINITE_TIMEOUT_EN</a>, <a class="el" href="a00099.html#l00065">HAL_NRF_PWR_DOWN</a>, <a class="el" href="a00099.html#l00066">HAL_NRF_PWR_UP</a>, <a class="el" href="a00099.html#l00116">hal_nrf_set_power_mode</a>, and <a class="el" href="a00099.html#l00114">hal_nrf_set_rf_channel</a>.
<p>
Referenced by <a class="el" href="a00088.html#l00208">fap_timer_interrupt()</a>.<div class="fragment"><pre class="fragment"><a name="l00593"></a>00593 {
<a name="l00594"></a>00594   <a class="code" href="a00068.html#g538e38bebf316b3a165afa6ec80f80b1">FAP_NRF_IRQ_DISABLE</a>();                    
<a name="l00595"></a>00595   
<a name="l00596"></a>00596   <span class="keywordflow">if</span>(<a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a>==<a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c869789c4a1edf3ad50e19eaf13e1d7892cc2f">FAP_TRANSMITTING</a>) 
<a name="l00597"></a>00597   { 
<a name="l00598"></a>00598     <span class="keywordflow">if</span>(<a class="code" href="a00025.html#a83b88b5ab42840f8a5a64342be0d5ba">fap_radio_startup_counter</a>&gt;0)      
<a name="l00599"></a>00599     {
<a name="l00600"></a>00600       <a class="code" href="a00025.html#a83b88b5ab42840f8a5a64342be0d5ba">fap_radio_startup_counter</a>--;
<a name="l00601"></a>00601     }
<a name="l00602"></a>00602     <span class="keywordflow">else</span>
<a name="l00603"></a>00603     <span class="keywordflow">if</span>(<a class="code" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b75787cc22817c3d5028085ce0b8cb56f">FAP_START_NEW_TX</a>))
<a name="l00604"></a>00604     {
<a name="l00605"></a>00605       <a class="code" href="a00030.html#0b7419f0782729de0b8ffabffab8e995">CE_HIGH</a>();                             
<a name="l00606"></a>00606       <a class="code" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b75787cc22817c3d5028085ce0b8cb56f">FAP_START_NEW_TX</a>);
<a name="l00607"></a>00607     }     
<a name="l00608"></a>00608   }
<a name="l00609"></a>00609   <span class="keywordflow">else</span>  
<a name="l00610"></a>00610   <span class="keywordflow">if</span>(<a class="code" href="a00025.html#3ec0a56740f472d6302004e9ffcdd40a">fap_mode</a>==<a class="code" href="a00067.html#gge9ac64bf8d27b84d9ceede9028c8697867e95ead0704559b85e6193170e13392">FAP_RECEIVING</a>)
<a name="l00611"></a>00611   {   
<a name="l00612"></a>00612     <span class="keywordflow">if</span>(<a class="code" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(<a class="code" href="a00025.html#15f635f7fe60e6850d194081afbcdd9f">fap_status</a>, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b671d3bd25264460673bc79b7405ce414">FAP_TX_RX_INFINITE_TIMEOUT_EN</a>) || (!<a class="code" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(fap_status, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b671d3bd25264460673bc79b7405ce414">FAP_TX_RX_INFINITE_TIMEOUT_EN</a>) &amp;&amp; <a class="code" href="a00025.html#fac0a12b2c8ed9ae94fa2cbc6ab17ed1">fap_latency_counter</a>&gt;0))
<a name="l00613"></a>00613     {     
<a name="l00614"></a>00614       <a class="code" href="a00025.html#fac0a12b2c8ed9ae94fa2cbc6ab17ed1">fap_latency_counter</a>--;
<a name="l00615"></a>00615       <span class="keywordflow">if</span>(!<a class="code" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(fap_status, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b6f11fadf5d6a6de810c7bb73ebd5e4c7">FAP_LP_RX_EN</a>))    
<a name="l00616"></a>00616       {  
<a name="l00617"></a>00617         <a class="code" href="a00025.html#3643b1cbe7f1d5819b849e943d454acc">fap_ch_tab_idx_rx</a> = (<a class="code" href="a00025.html#3643b1cbe7f1d5819b849e943d454acc">fap_ch_tab_idx_rx</a>+1) % <a class="code" href="a00059.html#aa26657c26f5abafd448320a4e45983d">FAP_CH_TAB_SIZE</a>;             
<a name="l00618"></a>00618           
<a name="l00619"></a>00619         <span class="keywordflow">if</span>(<a class="code" href="a00025.html#82997674dcc4273bf292fd681ec199a7">fap_hold_rx_channel</a> == 0)
<a name="l00620"></a>00620         {     
<a name="l00621"></a>00621           <a class="code" href="a00030.html#2507e21a12efd35e9e9221903456fbc9">CE_LOW</a>();
<a name="l00622"></a>00622           <a class="code" href="a00030.html#887c567677a6475cef9b55089918ee7b">hal_nrf_set_rf_channel</a>(<a class="code" href="a00025.html#47208fa4ba15fee8caab858a70381a77">fap_ch_tab</a>[<a class="code" href="a00025.html#3643b1cbe7f1d5819b849e943d454acc">fap_ch_tab_idx_rx</a>]);   
<a name="l00623"></a>00623           <a class="code" href="a00030.html#0b7419f0782729de0b8ffabffab8e995">CE_HIGH</a>();
<a name="l00624"></a>00624         }
<a name="l00625"></a>00625         <span class="keywordflow">else</span>
<a name="l00626"></a>00626         {
<a name="l00627"></a>00627           <a class="code" href="a00025.html#82997674dcc4273bf292fd681ec199a7">fap_hold_rx_channel</a>--;
<a name="l00628"></a>00628         } 
<a name="l00629"></a>00629       } 
<a name="l00630"></a>00630       <span class="keywordflow">else</span>
<a name="l00631"></a>00631       {
<a name="l00632"></a>00632         <span class="keywordflow">if</span>(<a class="code" href="a00025.html#c05ef73eb0018ffdbc75f4dda3b68258">fap_timer_period</a>==0)
<a name="l00633"></a>00633         {
<a name="l00634"></a>00634           <span class="comment">// Change channel</span>
<a name="l00635"></a>00635           <span class="keywordflow">if</span>(<a class="code" href="a00025.html#c05ef73eb0018ffdbc75f4dda3b68258">fap_timer_period</a>==0) 
<a name="l00636"></a>00636           {
<a name="l00637"></a>00637             <a class="code" href="a00025.html#3643b1cbe7f1d5819b849e943d454acc">fap_ch_tab_idx_rx</a> = (<a class="code" href="a00025.html#3643b1cbe7f1d5819b849e943d454acc">fap_ch_tab_idx_rx</a>+1) % <a class="code" href="a00059.html#aa26657c26f5abafd448320a4e45983d">FAP_CH_TAB_SIZE</a>;          
<a name="l00638"></a>00638             <a class="code" href="a00030.html#887c567677a6475cef9b55089918ee7b">hal_nrf_set_rf_channel</a>(<a class="code" href="a00025.html#47208fa4ba15fee8caab858a70381a77">fap_ch_tab</a>[<a class="code" href="a00025.html#3643b1cbe7f1d5819b849e943d454acc">fap_ch_tab_idx_rx</a>]);
<a name="l00639"></a>00639           }
<a name="l00640"></a>00640           <a class="code" href="a00030.html#3334b75f295de730325aeb0ab47b471a">hal_nrf_set_power_mode</a>(<a class="code" href="a00030.html#c4d45d9ed6219f65866b090cd84543e4">HAL_NRF_PWR_UP</a>);
<a name="l00641"></a>00641           <a class="code" href="a00067.html#ge693b6149cda30d26146738f1e1642e2">FAP_SET_BIT</a>(fap_status, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>);
<a name="l00642"></a>00642         }
<a name="l00643"></a>00643 
<a name="l00644"></a>00644         <span class="keywordflow">if</span>(<a class="code" href="a00025.html#c05ef73eb0018ffdbc75f4dda3b68258">fap_timer_period</a>==<a class="code" href="a00067.html#gc0db914b411d5004cf37446c9a4b0981">FAP_RX_FULL_CH_REV</a>)
<a name="l00645"></a>00645         {
<a name="l00646"></a>00646           <a class="code" href="a00030.html#2507e21a12efd35e9e9221903456fbc9">CE_LOW</a>();
<a name="l00647"></a>00647           <a class="code" href="a00030.html#3334b75f295de730325aeb0ab47b471a">hal_nrf_set_power_mode</a>(<a class="code" href="a00030.html#4683c4ed43fd24aa5680133eae96cbdb">HAL_NRF_PWR_DOWN</a>);
<a name="l00648"></a>00648           <a class="code" href="a00067.html#gb647c79572b09f3c7b8cdeb6deaea05d">FAP_CLEAR_BIT</a>(fap_status, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b563f6dddb27a48c6050960d568f47183">FAP_RADIO_PWR_UP</a>);
<a name="l00649"></a>00649         }
<a name="l00650"></a>00650 
<a name="l00651"></a>00651         <span class="keywordflow">if</span>(<a class="code" href="a00025.html#c05ef73eb0018ffdbc75f4dda3b68258">fap_timer_period</a> &lt; <a class="code" href="a00067.html#gc0db914b411d5004cf37446c9a4b0981">FAP_RX_FULL_CH_REV</a>)
<a name="l00652"></a>00652         {
<a name="l00653"></a>00653           <span class="comment">// RX on</span>
<a name="l00654"></a>00654           <span class="keywordflow">if</span>( ( (<a class="code" href="a00025.html#c05ef73eb0018ffdbc75f4dda3b68258">fap_timer_period</a>-<a class="code" href="a00067.html#g84b9c34cb03fefbee1372030b0ff6351">FAP_RADIO_PWR_UP_DELAY</a>) % <a class="code" href="a00067.html#g88bbdb70a1eeb3f35c6b72ba5cb5e74e">FAP_RX_SINGLE_CH_REV</a>) == 0)          
<a name="l00655"></a>00655           {
<a name="l00656"></a>00656             <a class="code" href="a00030.html#0b7419f0782729de0b8ffabffab8e995">CE_HIGH</a>();    
<a name="l00657"></a>00657           }
<a name="l00658"></a>00658           <span class="comment">// RX off  </span>
<a name="l00659"></a>00659           <span class="keywordflow">if</span>( ( (<a class="code" href="a00025.html#c05ef73eb0018ffdbc75f4dda3b68258">fap_timer_period</a>-<a class="code" href="a00067.html#g84b9c34cb03fefbee1372030b0ff6351">FAP_RADIO_PWR_UP_DELAY</a>-<a class="code" href="a00067.html#gccd7d43c3b6830cbc3deb246fb68b789">FAP_LP_RX_LISTEN_PERIODS</a>) % <a class="code" href="a00067.html#g88bbdb70a1eeb3f35c6b72ba5cb5e74e">FAP_RX_SINGLE_CH_REV</a>) == 0) 
<a name="l00660"></a>00660           {
<a name="l00661"></a>00661             <a class="code" href="a00030.html#2507e21a12efd35e9e9221903456fbc9">CE_LOW</a>();
<a name="l00662"></a>00662           }
<a name="l00663"></a>00663         }
<a name="l00664"></a>00664       }
<a name="l00665"></a>00665     }
<a name="l00666"></a>00666     <span class="keywordflow">else</span>
<a name="l00667"></a>00667     {
<a name="l00668"></a>00668       <a class="code" href="a00025.html#a02254cf544ab0f0211a71ebc4755d57">fap_set_system_idle</a>();  
<a name="l00669"></a>00669     }
<a name="l00670"></a>00670     
<a name="l00671"></a>00671     <span class="keywordflow">if</span>(<a class="code" href="a00067.html#g7c799138f2a82a777244f453d993acf9">FAP_GET_BIT</a>(fap_status, <a class="code" href="a00025.html#5b9361df3443d771e486a80cf1e3d12b6f11fadf5d6a6de810c7bb73ebd5e4c7">FAP_LP_RX_EN</a>))     
<a name="l00672"></a>00672     {
<a name="l00673"></a>00673       <a class="code" href="a00025.html#c05ef73eb0018ffdbc75f4dda3b68258">fap_timer_period</a> = (<a class="code" href="a00025.html#c05ef73eb0018ffdbc75f4dda3b68258">fap_timer_period</a> + 1) % <a class="code" href="a00059.html#6787d88427aef92169872169a3f5a584">FAP_LP_RX_POLL_PERIOD</a>;
<a name="l00674"></a>00674     }
<a name="l00675"></a>00675     <span class="keywordflow">else</span>
<a name="l00676"></a>00676     {
<a name="l00677"></a>00677       <a class="code" href="a00025.html#c05ef73eb0018ffdbc75f4dda3b68258">fap_timer_period</a> = (<a class="code" href="a00025.html#c05ef73eb0018ffdbc75f4dda3b68258">fap_timer_period</a> + 1) % <a class="code" href="a00059.html#aa26657c26f5abafd448320a4e45983d">FAP_CH_TAB_SIZE</a>;
<a name="l00678"></a>00678     }
<a name="l00679"></a>00679   } 
<a name="l00680"></a>00680   <a class="code" href="a00025.html#ef1fae944bed2970c1f1d41cb7843f04">fap_rx_channel_guess</a> = (<a class="code" href="a00025.html#ef1fae944bed2970c1f1d41cb7843f04">fap_rx_channel_guess</a> + 1) % <a class="code" href="a00059.html#aa26657c26f5abafd448320a4e45983d">FAP_CH_TAB_SIZE</a>;
<a name="l00681"></a>00681   
<a name="l00682"></a>00682   <a class="code" href="a00068.html#gd9e7233e67c4e5958d7bc0c929fb6b64">FAP_NRF_IRQ_ENABLE</a>();                      
<a name="l00683"></a>00683 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="a00067_g7a93db234bd573547615a02e536af4f3_cgraph.png" border="0" usemap="#a00067_g7a93db234bd573547615a02e536af4f3_cgraph_map" alt=""></center>
<map name="a00067_g7a93db234bd573547615a02e536af4f3_cgraph_map">
<area href="a00025.html#a02254cf544ab0f0211a71ebc4755d57" shape="rect" coords="209,5,353,32" alt="">
</map>

<p>
Here is the caller graph for this function:<p><center><img src="a00067_g7a93db234bd573547615a02e536af4f3_icgraph.png" border="0" usemap="#a00067_g7a93db234bd573547615a02e536af4f3_icgraph_map" alt=""></center>
<map name="a00067_g7a93db234bd573547615a02e536af4f3_icgraph_map">
<area href="a00019.html#5fb55d0871ad043d913b733c8fbcf0cd" shape="rect" coords="208,5,344,32" alt="">
</map>

</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Mon Jul 7 16:30:35 2008 for ATMEL by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
