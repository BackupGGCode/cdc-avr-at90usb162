<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ATMEL: FAPtoNRF_API.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>FAPtoNRF_API.h</h1><a href="a00030.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*This file has been prepared for Doxygen automatic documentation generation.*/</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="comment">/* Copyright (c) 2007, Atmel Corporation All rights reserved.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00017"></a>00017 <span class="comment"> * modification, are permitted provided that the following conditions are met:</span>
<a name="l00018"></a>00018 <span class="comment"> *</span>
<a name="l00019"></a>00019 <span class="comment"> * 1. Redistributions of source code must retain the above copyright notice,</span>
<a name="l00020"></a>00020 <span class="comment"> * this list of conditions and the following disclaimer.</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright notice,</span>
<a name="l00023"></a>00023 <span class="comment"> * this list of conditions and the following disclaimer in the documentation</span>
<a name="l00024"></a>00024 <span class="comment"> * and/or other materials provided with the distribution.</span>
<a name="l00025"></a>00025 <span class="comment"> *</span>
<a name="l00026"></a>00026 <span class="comment"> * 3. The name of ATMEL may not be used to endorse or promote products derived</span>
<a name="l00027"></a>00027 <span class="comment"> * from this software without specific prior written permission.</span>
<a name="l00028"></a>00028 <span class="comment"> *</span>
<a name="l00029"></a>00029 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY ATMEL ``AS IS'' AND ANY EXPRESS OR IMPLIED</span>
<a name="l00030"></a>00030 <span class="comment"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF</span>
<a name="l00031"></a>00031 <span class="comment"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE EXPRESSLY AND</span>
<a name="l00032"></a>00032 <span class="comment"> * SPECIFICALLY DISCLAIMED. IN NO EVENT SHALL ATMEL BE LIABLE FOR ANY DIRECT,</span>
<a name="l00033"></a>00033 <span class="comment"> * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span>
<a name="l00034"></a>00034 <span class="comment"> * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span>
<a name="l00035"></a>00035 <span class="comment"> * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</span>
<a name="l00036"></a>00036 <span class="comment"> * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00037"></a>00037 <span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF</span>
<a name="l00038"></a>00038 <span class="comment"> * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00039"></a>00039 <span class="comment"> */</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="preprocessor">#include "<a class="code" href="a00036.html">lib_board/nrf24l01/nRF_API.h</a>"</span>                      <span class="comment">//includes the NRF driver API</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include "lib_MCU/compiler.h"</span>                                <span class="comment">//includes the compiler definitions</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include "<a class="code" href="a00044.html">lib_mcu/spi/spi_lib.h</a>"</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="comment">//----Definition of variables formats----</span>
<a name="l00047"></a>00047 
<a name="l00048"></a><a class="code" href="a00030.html#b077fa1127453be2bd9d4c3c8a768fa7">00048</a> <span class="preprocessor">#define uint8_t      U8</span>
<a name="l00049"></a><a class="code" href="a00030.html#395b3b2bf5cb4674ab41b6bda68c15bb">00049</a> <span class="preprocessor"></span><span class="preprocessor">#define uint16_t     U16  </span>
<a name="l00050"></a><a class="code" href="a00030.html#9702e5ca80edeea90fa9b8fae49f05ce">00050</a> <span class="preprocessor"></span><span class="preprocessor">#define int8_t       S8</span>
<a name="l00051"></a><a class="code" href="a00030.html#ba47ebc2ca6caf60d3de4971843aa4cf">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define int16_t      S16</span>
<a name="l00052"></a><a class="code" href="a00030.html#969183bdd4954c0580326ad3b2d61933">00052</a> <span class="preprocessor"></span><span class="preprocessor">#define hal_nrf_output_power_t  U8</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>
<a name="l00054"></a>00054 <span class="comment">//-----------------Definition of constants-------------------------</span>
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="a00030.html#38209624f0cb2a3a494765662db5d1a6">00056</a> <span class="preprocessor">#define HAL_NRF_CRC_OFF      0   </span>
<a name="l00057"></a><a class="code" href="a00030.html#dc293a439205057ff70c12e5fab06883">00057</a> <span class="preprocessor">#define HAL_NRF_CRC_8BIT     2   </span>
<a name="l00058"></a><a class="code" href="a00030.html#c775b5b7d86020c853609972cdd2f324">00058</a> <span class="preprocessor">#define HAL_NRF_CRC_16BIT    3   </span>
<a name="l00059"></a><a class="code" href="a00030.html#24dcfbc0894d792e83117de274b85462">00059</a> <span class="preprocessor">#define HAL_NRF_1MBPS        0   </span>
<a name="l00060"></a><a class="code" href="a00030.html#d52e0b38849c9cd1c9ba7670b7de869c">00060</a> <span class="preprocessor">#define HAL_NRF_2MBPS        1   </span>
<a name="l00061"></a><a class="code" href="a00030.html#7b174656ac1e8abb8585a1c3ef4c578f">00061</a> <span class="preprocessor">#define HAL_NRF_18DBM        0   </span>
<a name="l00062"></a><a class="code" href="a00030.html#775d18fdea40ffb8758aa01050455396">00062</a> <span class="preprocessor">#define HAL_NRF_12DBM        1   </span>
<a name="l00063"></a><a class="code" href="a00030.html#266f5563fe6047f8ad7d31eb15f1b5cf">00063</a> <span class="preprocessor">#define HAL_NRF_6DBM         2   </span>
<a name="l00064"></a><a class="code" href="a00030.html#83fe85cf738935f4f7fe719aa4b384df">00064</a> <span class="preprocessor">#define HAL_NRF_0DBM         3   </span>
<a name="l00065"></a><a class="code" href="a00030.html#4683c4ed43fd24aa5680133eae96cbdb">00065</a> <span class="preprocessor">#define HAL_NRF_PWR_DOWN     0   </span>
<a name="l00066"></a><a class="code" href="a00030.html#c4d45d9ed6219f65866b090cd84543e4">00066</a> <span class="preprocessor">#define HAL_NRF_PWR_UP       1   </span>
<a name="l00067"></a><a class="code" href="a00030.html#41987623eab14c90171466953e5569e0">00067</a> <span class="preprocessor">#define HAL_NRF_PIPE0        0   </span>
<a name="l00068"></a><a class="code" href="a00030.html#9847e35660259f8ace9cd8aaf8e0b54e">00068</a> <span class="preprocessor">#define HAL_NRF_PIPE1        1   </span>
<a name="l00069"></a><a class="code" href="a00030.html#fe9810240ae3c2abaee04e2e0ae87306">00069</a> <span class="preprocessor">#define HAL_NRF_PIPE2        2   </span>
<a name="l00070"></a><a class="code" href="a00030.html#9ab5c9e8afaaf0e0ef1f577fecd16f0b">00070</a> <span class="preprocessor">#define HAL_NRF_PIPE3        3   </span>
<a name="l00071"></a><a class="code" href="a00030.html#255ca37d371e49b2fbc477d4979274ec">00071</a> <span class="preprocessor">#define HAL_NRF_PIPE4        4   </span>
<a name="l00072"></a><a class="code" href="a00030.html#b2fae25c533041b4318a4f2051bad915">00072</a> <span class="preprocessor">#define HAL_NRF_PIPE5        5   </span>
<a name="l00073"></a><a class="code" href="a00030.html#a262d7f9c849c6ae96fcc515595c85de">00073</a> <span class="preprocessor">#define HAL_NRF_TX           6   </span>
<a name="l00074"></a><a class="code" href="a00030.html#58ed45a84a9c36b6b94cd99f3a23cbe8">00074</a> <span class="preprocessor">#define HAL_NRF_ALL       0xFF   </span>
<a name="l00075"></a><a class="code" href="a00030.html#b8e82071759222570939b742a5c862a4">00075</a> <span class="preprocessor">#define HAL_NRF_PTX          0   </span>
<a name="l00076"></a><a class="code" href="a00030.html#a4a2b3f412c7dd9e6eefaa73dee3b09c">00076</a> <span class="preprocessor">#define HAL_NRF_PRX          1   </span>
<a name="l00077"></a><a class="code" href="a00030.html#68bca2b1429420aa46d2da0b2830e1b1">00077</a> <span class="preprocessor">#define RD_RX_PLOAD_W     0x60  </span>
<a name="l00078"></a><a class="code" href="a00030.html#97a60093aef6135e38bd0bd91cd40428">00078</a> <span class="preprocessor"></span><span class="preprocessor">#define WR_TX_PLOAD       0xA0  </span>
<a name="l00079"></a><a class="code" href="a00030.html#07b82f8a30b55b02b77c87d6d4953f6d">00079</a> <span class="preprocessor"></span><span class="preprocessor">#define WR_ACK_PLOAD      0xA8  </span>
<a name="l00080"></a><a class="code" href="a00030.html#475a03dfa6b8358e02ac25c1bc8a5de7">00080</a> <span class="preprocessor"></span><span class="preprocessor">#define WR_NAC_TX_PLOAD   0xB0  </span>
<a name="l00081"></a><a class="code" href="a00030.html#e79cde384e0b6a5549efb001589a79ec">00081</a> <span class="preprocessor"></span><span class="preprocessor">#define DYNPD             0x1C  </span>
<a name="l00082"></a><a class="code" href="a00030.html#df81f7b30b6c08465ce704956b446a2d">00082</a> <span class="preprocessor">#define FEATURE           0x1D  </span>
<a name="l00085"></a>00085 <span class="preprocessor">// Status bits definition</span>
<a name="l00086"></a><a class="code" href="a00030.html#8875452ea824d9cdaec5bbf520bcc6fa">00086</a> <span class="preprocessor"></span><span class="preprocessor">#define NRF_RX_DR            6  </span>
<a name="l00087"></a><a class="code" href="a00030.html#c9a034cc44596576c8ba9b90b4d34e40">00087</a> <span class="preprocessor">#define NRF_TX_DS            5  </span>
<a name="l00088"></a><a class="code" href="a00030.html#11b455442742b748465a21aa5a5a1ee8">00088</a> <span class="preprocessor">#define NRF_TX_DR            5  </span>
<a name="l00089"></a><a class="code" href="a00030.html#a8de80d008bac8de2eea8041f5b7fbd1">00089</a> <span class="preprocessor">#define NRF_MAX_RT           4  </span>
<a name="l00096"></a>00096 <span class="preprocessor">//-------------- Public and usefull NRF driver access for FAP --------------------------</span>
<a name="l00097"></a>00097 <span class="preprocessor"></span>
<a name="l00098"></a>00098 
<a name="l00099"></a><a class="code" href="a00030.html#2507e21a12efd35e9e9221903456fbc9">00099</a> <span class="preprocessor">#define CE_LOW()                          (NRF_disable())                                                           </span>
<a name="l00100"></a><a class="code" href="a00030.html#0b7419f0782729de0b8ffabffab8e995">00100</a> <span class="preprocessor">#define CE_HIGH()                         (NRF_enable())                                                            </span>
<a name="l00101"></a>00101 <span class="preprocessor">void hal_nrf_lock_unlock();                                                                                         </span>
<a name="l00104"></a><a class="code" href="a00030.html#130b6693c1bed3396e20fa60eb600b3a">00104</a> <span class="preprocessor">#define hal_nrf_write_reg(reg,val)        (NRF_enable(),NRF_disable(),NFR_write_reg(reg,val))                       </span>
<a name="l00105"></a><a class="code" href="a00030.html#fca9e65f7330ace9ee42489f488c33c9">00105</a> <span class="preprocessor">#define hal_nrf_read_reg(reg)             (NRF_enable(),NFR_read_reg(reg))                                          </span>
<a name="l00106"></a>00106 <span class="preprocessor">U16 hal_nrf_read_rx_pload(U8 *buf);                                                                                 </span>
<a name="l00107"></a><a class="code" href="a00030.html#bfebd7a1f3a3e4dc8d2790a88055e1f8">00107</a> <span class="preprocessor">#define hal_nrf_enable_ack_pl()           (NFR_write_reg(FEATURE, (NFR_read_reg(FEATURE) | 0x02)))                  </span>
<a name="l00108"></a>00108 <span class="preprocessor">void hal_nrf_write_ack_pload(U8 pipe, U8 *tx_pload, U8 length);                                                     </span>
<a name="l00109"></a><a class="code" href="a00030.html#76d5fae13ba309253f4dea387ea72111">00109</a> <span class="preprocessor">#define hal_nrf_write_tx_pload(buf,n)     (NRF_tx_buffer(buf,n))                                                    </span>
<a name="l00110"></a><a class="code" href="a00030.html#d578f0da2551eea2b0a6d725e329101d">00110</a> <span class="preprocessor">#define hal_nrf_flush_rx()                (NRF_flush_rx())                                                          </span>
<a name="l00111"></a><a class="code" href="a00030.html#7b78e68c0d96859d77df776fbb1cb247">00111</a> <span class="preprocessor">#define hal_nrf_flush_tx()                (NFR_write_reg(FLUSH_TX,0))                                               </span>
<a name="l00114"></a><a class="code" href="a00030.html#887c567677a6475cef9b55089918ee7b">00114</a> <span class="preprocessor">#define hal_nrf_set_rf_channel(n)         (NRF_set_channel(n))                                                      </span>
<a name="l00115"></a><a class="code" href="a00030.html#21236deff13ec979d07f3034a6fe4960">00115</a> <span class="preprocessor">#define hal_nrf_set_output_power(power)   (NFR_write_reg(RF_SETUP, ((NFR_read_reg(RF_SETUP) &amp; 0xF9) | (power&lt;&lt;1)))) </span>
<a name="l00116"></a><a class="code" href="a00030.html#3334b75f295de730325aeb0ab47b471a">00116</a> <span class="preprocessor">#define hal_nrf_set_power_mode(en)        (NFR_write_reg(CONFIG, ((NFR_read_reg(CONFIG) &amp; 0xFD) | (en&lt;&lt;1))))        </span>
<a name="l00117"></a><a class="code" href="a00030.html#264459a33aebd0f37e88642486e506dd">00117</a> <span class="preprocessor">#define hal_nrf_set_operation_mode(rtx)   (NFR_write_reg(CONFIG, ((NFR_read_reg(CONFIG) &amp; 0xFE) | rtx)))            </span>
<a name="l00118"></a><a class="code" href="a00030.html#a23954cf1f404b7fefa20a9d1938453f">00118</a> <span class="preprocessor">#define hal_nrf_set_datarate(rate)        (NFR_write_reg(RF_SETUP,(NFR_read_reg(RF_SETUP) &amp; 0xF7) | (rate&lt;&lt;3)))     </span>
<a name="l00119"></a><a class="code" href="a00030.html#005968b130c020935d0540234f38a993">00119</a> <span class="preprocessor">#define hal_nrf_set_crc_mode(mode)        (NFR_write_reg(CONFIG,(NFR_read_reg(CONFIG) &amp; 0xF3) | (mode&lt;&lt;2)))         </span>
<a name="l00122"></a><a class="code" href="a00030.html#1861341afb8f3d19e375053c850fd540">00122</a> <span class="preprocessor">#define hal_nrf_open_pipe(pipe, AutoAck)  (NRF_open_pipe(pipe, AutoAck))                                            </span>
<a name="l00123"></a><a class="code" href="a00030.html#9fc38033904e9880036ee16bdde2c0db">00123</a> <span class="preprocessor">#define hal_nrf_close_pipe(pipe)          (NRF_close_pipe(pipe))                                                    </span>
<a name="l00124"></a><a class="code" href="a00030.html#1e29d504df3a94f370341218a5cfc79d">00124</a> <span class="preprocessor">#define hal_nrf_set_address_width(width)  (NFR_write_reg(SETUP_AW, (width - 2)))</span>
<a name="l00125"></a><a class="code" href="a00030.html#7e996c76a4b82ca2327e7c1ee9a375f5">00125</a> <span class="preprocessor"></span><span class="preprocessor">#define hal_nrf_get_address_width()       (NFR_read_reg(SETUP_AW)+ 2)</span>
<a name="l00126"></a><a class="code" href="a00030.html#9a712862a3cdeabda3c742470586325d">00126</a> <span class="preprocessor"></span><span class="preprocessor">#define hal_nrf_get_transmit_attempts()   (NFR_read_reg(OBSERVE_TX) &amp; 0x0F)                                         </span>
<a name="l00127"></a>00127 <span class="preprocessor">U8 hal_nrf_get_address(U8 pipe, U8 *addr);                                                                          </span>
<a name="l00128"></a>00128 <span class="preprocessor">void hal_nrf_set_address(U8 pipe, U8 *addr);                                                                        </span>
<a name="l00129"></a>00129 <span class="preprocessor">void fap_modify_timer_period(void);                                                                                 </span>
<a name="l00130"></a>00130 <span class="preprocessor">void NRF_open_pipe(U8 pipe_num, U8 auto_ack);                                                                       </span>
<a name="l00131"></a>00131 <span class="preprocessor">void NRF_close_pipe(U8 pipe_num);                                                                                   </span>
<a name="l00134"></a><a class="code" href="a00030.html#45a98aa687b9e1289c0814b26c483895">00134</a> <span class="preprocessor">#define hal_nrf_rx_fifo_empty()           (NFR_read_reg(FIFO_STATUS) &amp; 0x01)                                        </span>
<a name="l00135"></a><a class="code" href="a00030.html#15d76b0cccaab7aa8f3be8d400b48037">00135</a> <span class="preprocessor">#define hal_nrf_tx_fifo_empty()           (NFR_read_reg(FIFO_STATUS) &amp; 0x10)                                        </span>
<a name="l00136"></a><a class="code" href="a00030.html#f871858c69b4c21efa600cd0a5fd2c47">00136</a> <span class="preprocessor">#define hal_nrf_rx_fifo_full()            (NFR_read_reg(FIFO_STATUS) &amp; 0x02)                                        </span>
<a name="l00137"></a><a class="code" href="a00030.html#084c8c90dae6a297d8253344b0fdcf5d">00137</a> <span class="preprocessor">#define hal_nrf_tx_fifo_full()            (NFR_read_reg(FIFO_STATUS) &amp; 0x20)                                        </span>
<a name="l00140"></a><a class="code" href="a00030.html#c91c771ac6ea1910a50ecb83ec63b4eb">00140</a> <span class="preprocessor">#define hal_nrf_get_clear_irq_flags()     (NFR_write_reg(STATUS, (0x40|0x20|0x10)) &amp; (0x40|0x20|0x10))              </span>
<a name="l00143"></a><a class="code" href="a00030.html#04a057b25612826e0338615554bf7c1d">00143</a> <span class="preprocessor">#define hal_nrf_enable_dynamic_pl()       (NFR_write_reg(FEATURE,NFR_read_reg(FEATURE) | 0x04))                     </span>
<a name="l00144"></a><a class="code" href="a00030.html#42186ca9eaadf3bf9183bbf4415d56d1">00144</a> <span class="preprocessor">#define hal_nrf_setup_dyn_pl(n)           (NFR_write_reg(DYNPD,n))                                                  </span>
<a name="l00145"></a><a class="code" href="a00030.html#3dafb8f75609071d396e3934e42a2547">00145</a> <span class="preprocessor">#define hal_nrf_set_auto_retr(retr,delay) (NFR_write_reg(SETUP_RETR, (((delay/250)-1)&lt;&lt;4) | retr))                  </span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Jul 7 16:29:49 2008 for ATMEL by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
